{"version":3,"sources":["../src/ctrl.js"],"names":["IS_LIGHT_THEME","config","theme","type","RGX_CELL_PLACEHOLDER","RGX_OLD_VAR_WORKAROUND","COUNT_TYPE_MAP","sum","_","avg","mean","min","max","count","arr","length","first","last","PANEL_DEFAULTS","chartType","BAR_DEFAULTS","orientation","categoryColumnName","seriesColumnName","stackColumnName","measureColumnName","drilldownLinks","borderWidth","colorBy","colorSource","colorColumnName","seriesColors","isStacked","dataBgColorAlpha","dataBorderColorAlpha","dataBorderBrightness","countType","numberFormat","numberFormatDecimals","tooltip","isCustom","titleFormat","labelFormat","labels","isShowing","format","isBlackText","wrapAfter","legend","position","isFullWidth","isReverse","scales","xAxes","ticks","autoSkip","minRotation","maxRotation","gridLineOpacity","yAxes","FUNNEL_DEFAULTS","hAlign","sortOrder","gap","startWidthPct","PIE_DEFAULTS","pieType","isSemiCircle","labelColumnName","OPTIONS_BY_TYPE","bar","Object","keys","JS","flattenKeys","pie","funnel","DISABLE_ANIMATIONS","test","parseQS","location","href","__noanimation","ChartJsPanelCtrl","$scope","$injector","$rootScope","UNIT_FORMATS","GRID_LINE_OPACITIES","value","text","CHART_START_WIDTH_PERCENTAGES","CHART_BORDER_WIDTHS","CHART_GAP_SIZES","CHART_COLOR_BY","CHART_COLOR_SOURCES","CHART_LABEL_SOURCES","CHART_TYPES","PIE_TYPES","COUNT_TYPES","concat","map","t","titleCase","CHART_ORIENTATIONS","CHART_H_ALIGNMENTS","SORT_ORDERS","COLOR_ALPHAS","range","x","BRIGHTNESSES","TICK_ROTATIONS","data","setPanelDefaults","events","on","onInitEditMode","bind","onDataReceived","onDataError","panel","defaultsDeep","forEach","key","has","opt_index","colors","splice","renderNow","fromIndex","toIndex","getChartPanel","drilldownLink","url","openInBlank","isActiveOption","category","series","push","links","indexOf","path","addEditorTab","dataList","columns","rows","columnTexts","col","row","assign","byColName","reduce","carry","cellValue","cellIndex","colIndexesByText","reduceRight","indexes","colText","index","obj","newValue","emit","paths","every","includes","set","name","opt_isOptional","isRequired","undefined","Error","e","jElem","error","isValid","ctrl","jContent","find","css","html","elemContent","jCanvas","jQuery","appendTo","canvas","prop","width","height","drawBarChart","drawFunnelChart","drawPieChart","console","msg","message","elemMsg","dom","style","display","alignItems","textAlign","$","cls","margin","append","fullPanel","labelOptions","categoryColIndex","getColIndex","seriesColIndex","measureColIndex","labelColIndex","colorColIndex","stackColIndex","ignoreSeries","categories","uniq","reverse","categoryCount","seriesCount","measureCount","rowIndex","seriesIndex","measureIndex","measures","rowGroups","seriesStacks","countMeasures","i","sortMap","v","sort","a","b","remap","baseColors","seriesColorCount","seriesName","categoryIndex","colorIndex","colorCount","Color","hsl","Math","round","bgColors","color","rgba","borderColors","l","formatLabelText","strFormat","measure","replace","match","isEscapedDollar","isSeries","isCategory","colName","colFnName","Set","size","c","d","Array","from","join","toFixed","getLabelFormatter","defaultFormat","labelType","toLowerCase","isForChart","isForTooltip","tooltipItems","arguments","isForTitle","isArray","datasetIndex","labelItem","dataIndex","strMeasure","strResult","toUpperCase","formatLabel","tooltipCallbacks","title","label","testChartEvent","callback","elem","getElementAtEvent","isOpen","_datasetIndex","_index","some","drilldownLinkIndex","rgxCategory","rgxSeries","getChartOptions","datasets","fnFilter","filter","borderColor","backgroundColor","datalabels","anchor","rgb","borderRadius","formatter","chartConfig","responsive","options","circumference","PI","rotation","elements","tooltips","callbacks","fullWidth","fontColor","animation","animateScale","animateRotate","onClick","call","matchingRows","openDrilldownLink","hover","onHover","target","cursor","plugins","ChartDataLabels","ctx","getContext","Chart","PolarArea","stack","mode","userCallback","values","stacked","gridLines","myChart","dataset","startWidthPercent","keep","variables","templateSrv","timeSrv","isTime","opt_timePart","isRaw","isParam","paramName","timeRangeForUrl","to","encodeURIComponent","result","variable","varValues","toArray","current","isAll","includeAll","window","open","apply","scope","attrs","drawChart","debounce","MetricsPanelCtrl","unregister","templateUrl"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,cAAc,GAAGC,gBAAOC,KAAP,CAAaC,IAAb,KAAsB,OAA7C;AAEA,IAAMC,oBAAoB,GAAG,oHAA7B;AACA,IAAMC,sBAAsB,GAAG,kDAA/B;AAEA,IAAMC,cAAc,GAAG;AACrBC,EAAAA,GAAG,EAAEC,gBAAED,GADc;AAErBE,EAAAA,GAAG,EAAED,gBAAEE,IAFc;AAGrBC,EAAAA,GAAG,EAAEH,gBAAEG,GAHc;AAIrBC,EAAAA,GAAG,EAAEJ,gBAAEI,GAJc;AAKrBC,EAAAA,KAAK,EAAE,eAAAC,GAAG;AAAA,WAAIA,GAAG,CAACC,MAAR;AAAA,GALW;AAMrBC,EAAAA,KAAK,EAAE,eAAAF,GAAG;AAAA,WAAIA,GAAG,CAAC,CAAD,CAAP;AAAA,GANW;AAOrBG,EAAAA,IAAI,EAAE,cAAAH,GAAG;AAAA,WAAIA,GAAG,CAACA,GAAG,CAACC,MAAJ,GAAa,CAAd,CAAP;AAAA;AAPY,CAAvB;AAUA,IAAMG,cAAc,GAAG;AACrBC,EAAAA,SAAS,EAAE;AADU,CAAvB;AAIA,IAAMC,YAAY,GAAG;AACnBC,EAAAA,WAAW,EAAE,UADM;AAEnBC,EAAAA,kBAAkB,EAAE,IAFD;AAGnBC,EAAAA,gBAAgB,EAAE,IAHC;AAInBC,EAAAA,eAAe,EAAE,IAJE;AAKnBC,EAAAA,iBAAiB,EAAE,IALA;AAMnBC,EAAAA,cAAc,EAAE,EANG;AAOnBC,EAAAA,WAAW,EAAE,CAPM;AAQnBC,EAAAA,OAAO,EAAE,QARU;AASnBC,EAAAA,WAAW,EAAE,MATM;AAUnBC,EAAAA,eAAe,EAAE,IAVE;AAWnBC,EAAAA,YAAY,EAAE,EAXK;AAYnBC,EAAAA,SAAS,EAAE,KAZQ;AAanBC,EAAAA,gBAAgB,EAAE,IAbC;AAcnBC,EAAAA,oBAAoB,EAAE,CAdH;AAenBC,EAAAA,oBAAoB,EAAE,GAfH;AAgBnBC,EAAAA,SAAS,EAAE,KAhBQ;AAiBnBC,EAAAA,YAAY,EAAE,MAjBK;AAkBnBC,EAAAA,oBAAoB,EAAE,CAlBH;AAmBnBC,EAAAA,OAAO,EAAE;AACPC,IAAAA,QAAQ,EAAE,KADH;AAEPC,IAAAA,WAAW,EAAG,IAFP;AAGPC,IAAAA,WAAW,EAAE;AAHN,GAnBU;AAwBnBC,EAAAA,MAAM,EAAE;AACNC,IAAAA,SAAS,EAAE,KADL;AAENC,IAAAA,MAAM,EAAE,YAFF;AAGNC,IAAAA,WAAW,EAAE9C,cAHP;AAIN+C,IAAAA,SAAS,EAAE;AAJL,GAxBW;AA8BnBC,EAAAA,MAAM,EAAE;AACNJ,IAAAA,SAAS,EAAE,IADL;AAENK,IAAAA,QAAQ,EAAE,KAFJ;AAGNC,IAAAA,WAAW,EAAE,KAHP;AAINC,IAAAA,SAAS,EAAE;AAJL,GA9BW;AAoCnBC,EAAAA,MAAM,EAAE;AACNC,IAAAA,KAAK,EAAE;AACLC,MAAAA,KAAK,EAAE;AACLC,QAAAA,QAAQ,EAAE,IADL;AAELC,QAAAA,WAAW,EAAE,CAFR;AAGLC,QAAAA,WAAW,EAAE;AAHR,OADF;AAMLC,MAAAA,eAAe,EAAE;AANZ,KADD;AASNC,IAAAA,KAAK,EAAE;AACLL,MAAAA,KAAK,EAAE;AACLC,QAAAA,QAAQ,EAAE,IADL;AAELC,QAAAA,WAAW,EAAE,CAFR;AAGLC,QAAAA,WAAW,EAAE;AAHR,OADF;AAMLC,MAAAA,eAAe,EAAE;AANZ;AATD;AApCW,CAArB;AAwDA,IAAME,eAAe,GAAG;AACtBC,EAAAA,MAAM,EAAE,QADc;AAEtBC,EAAAA,SAAS,EAAE,MAFW;AAGtBxC,EAAAA,kBAAkB,EAAE,IAHE;AAItBG,EAAAA,iBAAiB,EAAE,IAJG;AAKtBC,EAAAA,cAAc,EAAE,EALM;AAMtBC,EAAAA,WAAW,EAAE,CANS;AAOtBE,EAAAA,WAAW,EAAE,MAPS;AAQtBC,EAAAA,eAAe,EAAE,IARK;AAStBC,EAAAA,YAAY,EAAE,EATQ;AAUtBE,EAAAA,gBAAgB,EAAE,IAVI;AAWtBC,EAAAA,oBAAoB,EAAE,CAXA;AAYtBC,EAAAA,oBAAoB,EAAE,GAZA;AAatBC,EAAAA,SAAS,EAAE,KAbW;AActBC,EAAAA,YAAY,EAAE,MAdQ;AAetBC,EAAAA,oBAAoB,EAAE,CAfA;AAgBtBC,EAAAA,OAAO,EAAE;AACPC,IAAAA,QAAQ,EAAE,KADH;AAEPC,IAAAA,WAAW,EAAG,IAFP;AAGPC,IAAAA,WAAW,EAAE;AAHN,GAhBa;AAqBtB;AACA;AACA;AACA;AACA;AACA;AACAqB,EAAAA,GAAG,EAAE,CA3BiB;AA4BtBC,EAAAA,aAAa,EAAE,GA5BO;AA6BtBhB,EAAAA,MAAM,EAAE;AACNJ,IAAAA,SAAS,EAAE,IADL;AAENK,IAAAA,QAAQ,EAAE,KAFJ;AAGNC,IAAAA,WAAW,EAAE,KAHP;AAINC,IAAAA,SAAS,EAAE;AAJL;AA7Bc,CAAxB;AAqCA,IAAMc,YAAY,GAAG;AACnBC,EAAAA,OAAO,EAAE,KADU;AAEnBC,EAAAA,YAAY,EAAE,KAFK;AAGnB7C,EAAAA,kBAAkB,EAAE,IAHD;AAInBC,EAAAA,gBAAgB,EAAE,IAJC;AAKnBE,EAAAA,iBAAiB,EAAE,IALA;AAMnB2C,EAAAA,eAAe,EAAE,IANE;AAOnB1C,EAAAA,cAAc,EAAE,EAPG;AAQnBC,EAAAA,WAAW,EAAE,CARM;AASnBC,EAAAA,OAAO,EAAE,MATU;AAUnBC,EAAAA,WAAW,EAAE,MAVM;AAWnBC,EAAAA,eAAe,EAAE,IAXE;AAYnBC,EAAAA,YAAY,EAAE,EAZK;AAanBE,EAAAA,gBAAgB,EAAE,IAbC;AAcnBE,EAAAA,oBAAoB,EAAE,GAdH;AAenBD,EAAAA,oBAAoB,EAAE,CAfH;AAgBnBE,EAAAA,SAAS,EAAE,KAhBQ;AAiBnBC,EAAAA,YAAY,EAAE,MAjBK;AAkBnBC,EAAAA,oBAAoB,EAAE,CAlBH;AAmBnBC,EAAAA,OAAO,EAAE;AACPC,IAAAA,QAAQ,EAAE,KADH;AAEPC,IAAAA,WAAW,EAAG,IAFP;AAGPC,IAAAA,WAAW,EAAE;AAHN,GAnBU;AAwBnBC,EAAAA,MAAM,EAAE;AACNC,IAAAA,SAAS,EAAE,KADL;AAENC,IAAAA,MAAM,EAAE,YAFF;AAGNC,IAAAA,WAAW,EAAE9C,cAHP;AAIN+C,IAAAA,SAAS,EAAE;AAJL,GAxBW;AA8BnBC,EAAAA,MAAM,EAAE;AACNJ,IAAAA,SAAS,EAAE,IADL;AAENK,IAAAA,QAAQ,EAAE,KAFJ;AAGNC,IAAAA,WAAW,EAAE,KAHP;AAINC,IAAAA,SAAS,EAAE;AAJL;AA9BW,CAArB;AAsCA,IAAMkB,eAAe,GAAG;AACtBC,EAAAA,GAAG,EAAEC,MAAM,CAACC,IAAP,CAAYC,gBAAGC,WAAH,CAAetD,YAAf,EAA6B,IAA7B,CAAZ,CADiB;AAEtBuD,EAAAA,GAAG,EAAEJ,MAAM,CAACC,IAAP,CAAYC,gBAAGC,WAAH,CAAeT,YAAf,EAA6B,IAA7B,CAAZ,CAFiB;AAGtBW,EAAAA,MAAM,EAAEL,MAAM,CAACC,IAAP,CAAYC,gBAAGC,WAAH,CAAed,eAAf,EAAgC,IAAhC,CAAZ;AAHc,CAAxB;AAMA,IAAMiB,kBAAkB,GAAG,CAAC,+BAA+BC,IAA/B,CAAoC,CAACL,gBAAGM,OAAH,CAAWC,QAAQ,CAACC,IAApB,EAA0BC,aAA3B,IAA4C,EAAhF,CAA5B;;IAEaC,gB;;;;;AACX,4BAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,UAA/B,EAA2C;AAAA;;AAAA;;AACzC,0FAAMF,MAAN,EAAcC,SAAd;AAEA,UAAKE,YAAL,GAAoB,0BAApB;AACA,UAAKC,mBAAL,GAA2B,CACzB;AAAEC,MAAAA,KAAK,EAAE,KAAT;AAAgBC,MAAAA,IAAI,EAAE;AAAtB,KADyB,EAEzB;AAAED,MAAAA,KAAK,EAAE,IAAT;AAAeC,MAAAA,IAAI,EAAE;AAArB,KAFyB,EAGzB;AAAED,MAAAA,KAAK,EAAE,IAAT;AAAeC,MAAAA,IAAI,EAAE;AAArB,KAHyB,CAA3B;AAKA,UAAKC,6BAAL,GAAqC,CACnC;AAAEF,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KADmC,EAEnC;AAAED,MAAAA,KAAK,EAAE,IAAT;AAAeC,MAAAA,IAAI,EAAE;AAArB,KAFmC,EAGnC;AAAED,MAAAA,KAAK,EAAE,GAAT;AAAcC,MAAAA,IAAI,EAAE;AAApB,KAHmC,EAInC;AAAED,MAAAA,KAAK,EAAE,IAAT;AAAeC,MAAAA,IAAI,EAAE;AAArB,KAJmC,EAKnC;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KALmC,CAArC;AAOA,UAAKE,mBAAL,GAA2B,CACzB;AAAEH,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KADyB,EAEzB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KAFyB,EAGzB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KAHyB,EAIzB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KAJyB,CAA3B;AAMA,UAAKG,eAAL,GAAuB,CACrB;AAAEJ,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KADqB,EAErB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KAFqB,EAGrB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KAHqB,EAIrB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KAJqB,EAKrB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KALqB,EAMrB;AAAED,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE;AAAlB,KANqB,CAAvB;AAQA,UAAKI,cAAL,GAAsB,CACpB;AAAEL,MAAAA,KAAK,EAAE,QAAT;AAAmBC,MAAAA,IAAI,EAAE;AAAzB,KADoB,EAEpB;AAAED,MAAAA,KAAK,EAAE,UAAT;AAAqBC,MAAAA,IAAI,EAAE;AAA3B,KAFoB,EAGpB;AAAED,MAAAA,KAAK,EAAE,MAAT;AAAiBC,MAAAA,IAAI,EAAE;AAAvB,KAHoB,CAAtB;AAKA,UAAKK,mBAAL,GAA2B,CACzB;AAAEN,MAAAA,KAAK,EAAE,QAAT;AAAmBC,MAAAA,IAAI,EAAE;AAAzB,KADyB,EAEzB;AAAED,MAAAA,KAAK,EAAE,MAAT;AAAiBC,MAAAA,IAAI,EAAE;AAAvB,KAFyB,EAGzB;AAAED,MAAAA,KAAK,EAAE,QAAT;AAAmBC,MAAAA,IAAI,EAAE;AAAzB,KAHyB,CAA3B;AAKA,UAAKM,mBAAL,GAA2B,CACzB;AAAEP,MAAAA,KAAK,EAAE,IAAT;AAAeC,MAAAA,IAAI,EAAE;AAArB,KADyB,EAEzB;AAAED,MAAAA,KAAK,EAAE,QAAT;AAAmBC,MAAAA,IAAI,EAAE;AAAzB,KAFyB,EAGzB;AAAED,MAAAA,KAAK,EAAE,QAAT;AAAmBC,MAAAA,IAAI,EAAE;AAAzB,KAHyB,CAA3B;AAKA,UAAKO,WAAL,GAAmB,CACjB;AAAER,MAAAA,KAAK,EAAE,IAAT;AAAe,cAAQ;AAAvB,KADiB,EAEjB;AAAEA,MAAAA,KAAK,EAAE,KAAT;AAAgBC,MAAAA,IAAI,EAAE;AAAtB,KAFiB,EAGjB;AAAED,MAAAA,KAAK,EAAE,QAAT;AAAmBC,MAAAA,IAAI,EAAE;AAAzB,KAHiB,EAIjB;AAAED,MAAAA,KAAK,EAAE,KAAT;AAAgBC,MAAAA,IAAI,EAAE;AAAtB,KAJiB,CAAnB;AAMA,UAAKQ,SAAL,GAAiB,CACf;AAAET,MAAAA,KAAK,EAAE,IAAT;AAAe,cAAQ;AAAvB,KADe,EAEf;AAAEA,MAAAA,KAAK,EAAE,KAAT;AAAgBC,MAAAA,IAAI,EAAE;AAAtB,KAFe,EAGf;AAAED,MAAAA,KAAK,EAAE,OAAT;AAAkBC,MAAAA,IAAI,EAAE;AAAxB,KAHe,EAIf;AAAED,MAAAA,KAAK,EAAE,UAAT;AAAqBC,MAAAA,IAAI,EAAE;AAA3B,KAJe,CAAjB;AAMA,UAAKS,WAAL,GAAmB,CAAC;AAAEV,MAAAA,KAAK,EAAE,IAAT;AAAeC,MAAAA,IAAI,EAAE;AAArB,KAAD,EAA4CU,MAA5C,CACjB7B,MAAM,CAACC,IAAP,CAAYlE,cAAZ,EAA4B+F,GAA5B,CAAgC,UAAAC,CAAC;AAAA,aAAK;AAAEb,QAAAA,KAAK,EAAEa,CAAT;AAAYZ,QAAAA,IAAI,EAAEjB,gBAAG8B,SAAH,CAAaD,CAAb;AAAlB,OAAL;AAAA,KAAjC,CADiB,CAAnB;AAGA,UAAKE,kBAAL,GAA0B,CACxB;AAAEf,MAAAA,KAAK,EAAE,YAAT;AAAuBC,MAAAA,IAAI,EAAE;AAA7B,KADwB,EAExB;AAAED,MAAAA,KAAK,EAAE,UAAT;AAAqBC,MAAAA,IAAI,EAAE;AAA3B,KAFwB,CAA1B;AAIA,UAAKe,kBAAL,GAA0B,CACxB;AAAEhB,MAAAA,KAAK,EAAE,MAAT;AAAiBC,MAAAA,IAAI,EAAE;AAAvB,KADwB,EAExB;AAAED,MAAAA,KAAK,EAAE,QAAT;AAAmBC,MAAAA,IAAI,EAAE;AAAzB,KAFwB,EAGxB;AAAED,MAAAA,KAAK,EAAE,OAAT;AAAkBC,MAAAA,IAAI,EAAE;AAAxB,KAHwB,CAA1B;AAKA,UAAKgB,WAAL,GAAmB,CACjB;AAAEjB,MAAAA,KAAK,EAAE,KAAT;AAAgBC,MAAAA,IAAI,EAAE;AAAtB,KADiB,EAEjB;AAAED,MAAAA,KAAK,EAAE,MAAT;AAAiBC,MAAAA,IAAI,EAAE;AAAvB,KAFiB,CAAnB;AAIA,UAAKiB,YAAL,GAAoBnG,gBAAEoG,KAAF,CAAQ,CAAR,EAAW,GAAX,EAAgB,CAAhB,EAAmBP,GAAnB,CAAuB,UAAAQ,CAAC;AAAA,aAAK;AAC/CpB,QAAAA,KAAK,EAAEoB,CAAC,GAAG,GADoC;AAC/BnB,QAAAA,IAAI,EAAE,UAAGmB,CAAH,UAAWA,CAAC,GAAGA,CAAC,KAAK,GAAN,GAAY,UAAZ,GAAyB,EAA5B,GAAiC,cAA7C;AADyB,OAAL;AAAA,KAAxB,CAApB;AAGA,UAAKC,YAAL,GAAoBtG,gBAAEoG,KAAF,CAAQ,CAAR,EAAW,GAAX,EAAgB,CAAhB,EAAmBP,GAAnB,CAAuB,UAAAQ,CAAC;AAAA,aAAK;AAC/CpB,QAAAA,KAAK,EAAEoB,CAAC,GAAG,GADoC;AAC/BnB,QAAAA,IAAI,EAAE,UAAGmB,CAAH,UAAWA,CAAC,GAAGA,CAAC,KAAK,GAAN,GAAY,UAAZ,GAAyB,EAA5B,GAAiC,UAA7C;AADyB,OAAL;AAAA,KAAxB,CAApB;AAGA,UAAKE,cAAL,GAAsBvG,gBAAEoG,KAAF,CAAQ,CAAR,EAAW,EAAX,EAAe,CAAf,EAAkBP,GAAlB,CAAsB,UAAAQ,CAAC;AAAA,aAAK;AAChDpB,QAAAA,KAAK,EAAEoB,CADyC;AACtCnB,QAAAA,IAAI,EAAE,UAAGmB,CAAH,aAAcA,CAAC,GAAGA,CAAC,KAAK,EAAN,GAAW,aAAX,GAA2B,EAA9B,GAAmC,eAAlD;AADgC,OAAL;AAAA,KAAvB,CAAtB;AAIA,UAAKvB,UAAL,GAAkBA,UAAlB;AACA,UAAK0B,IAAL,GAAY,IAAZ;;AAEA,UAAKC,gBAAL;;AAEA,UAAKC,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,MAAKC,cAAL,CAAoBC,IAApB,+BAAjC;;AACA,UAAKH,MAAL,CAAYC,EAAZ,CAAe,eAAf,EAAgC,MAAKG,cAAL,CAAoBD,IAApB,+BAAhC;;AACA,UAAKH,MAAL,CAAYC,EAAZ,CAAe,oBAAf,EAAqC,MAAKG,cAAL,CAAoBD,IAApB,+BAArC;;AACA,UAAKH,MAAL,CAAYC,EAAZ,CAAe,YAAf,EAA6B,MAAKI,WAAL,CAAiBF,IAAjB,+BAA7B;;AA3FyC;AA4F1C,G,CAED;AACA;;;;;uCACmB;AACjB,UAAIG,KAAK,GAAG,KAAKA,KAAjB;;AACAhH,sBAAEiH,YAAF,CAAeD,KAAf,EAAsBtG,cAAtB;;AACA,cAAQsG,KAAK,CAACrG,SAAd;AACE,aAAK,eAAL;AACEqG,UAAAA,KAAK,CAACrG,SAAN,GAAkB,KAAlB;AACAqG,UAAAA,KAAK,CAACnG,WAAN,GAAoB,YAApB;;AACF,aAAK,KAAL;AACE,cAAI,CAACmG,KAAK,CAAClD,GAAX,EAAgB;AACdkD,YAAAA,KAAK,CAAClD,GAAN,GAAY,EAAZ;AACD;;AACD9D,0BAAEiH,YAAF,CAAeD,KAAK,CAAClD,GAArB,EAA0BlD,YAA1B;;AACAmD,UAAAA,MAAM,CAACC,IAAP,CAAYpD,YAAZ,EAA0BsG,OAA1B,CAAkC,UAAAC,GAAG,EAAI;AACvC,gBAAInH,gBAAEoH,GAAF,CAAMJ,KAAN,EAAaG,GAAb,CAAJ,EAAuB;AACrBH,cAAAA,KAAK,CAAClD,GAAN,CAAUqD,GAAV,IAAiBH,KAAK,CAACG,GAAD,CAAtB;AACA,qBAAOH,KAAK,CAACG,GAAD,CAAZ;AACD;AACF,WALD;AAMA;;AAEF,aAAK,QAAL;AACEnH,0BAAEiH,YAAF,CAAeD,KAAK,CAAC5C,MAAN,GAAe4C,KAAK,CAAC5C,MAAN,IAAgB,EAA9C,EAAkDhB,eAAlD;;AACA;;AAEF,aAAK,KAAL;AACEpD,0BAAEiH,YAAF,CAAeD,KAAK,CAAC7C,GAAN,GAAY6C,KAAK,CAAC7C,GAAN,IAAa,EAAxC,EAA4CV,YAA5C;;AACA;AAvBJ;AAyBD;;;mCAEc4D,S,EAAW;AACxB,UAAIL,KAAK,GAAG,KAAKA,KAAjB;AACA,UAAIM,MAAM,GAAGN,KAAK,CAACA,KAAK,CAACrG,SAAP,CAAL,CAAuBY,YAApC;AACA+F,MAAAA,MAAM,CAACC,MAAP,CAAcF,SAAS,IAAI,IAAb,GAAoBC,MAAM,CAAC/G,MAA3B,GAAoC8G,SAAlD,EAA6D,CAA7D,EAAgE,uBAAM,OAAN,IAAiB,EAAjF;AACA,WAAKG,SAAL;AACD;;;oCAEeC,S,EAAWC,O,EAAS;AAClC,UAAIJ,MAAM,GAAG,KAAKK,aAAL,GAAqBpG,YAAlC;AACA+F,MAAAA,MAAM,CAACC,MAAP,CAAcG,OAAd,EAAuB,CAAvB,EAA0BJ,MAAM,CAACC,MAAP,CAAcE,SAAd,EAAyB,CAAzB,EAA4B,CAA5B,CAA1B;AACA,WAAKD,SAAL;AACD;;;sCAEiBH,S,EAAW;AAC3B,UAAIL,KAAK,GAAG,KAAKA,KAAjB;AACA,UAAIM,MAAM,GAAGN,KAAK,CAACA,KAAK,CAACrG,SAAP,CAAL,CAAuBY,YAApC;AACA,UAAIlB,KAAK,GAAGiH,MAAM,CAAC/G,MAAnB;;AACA,UAAIF,KAAJ,EAAW;AACTiH,QAAAA,MAAM,CAACC,MAAP,CAAcF,SAAS,IAAI,IAAb,GAAoBhH,KAAK,GAAG,CAA5B,GAAgCgH,SAA9C,EAAyD,CAAzD;AACA,aAAKG,SAAL;AACD;AACF;;;uCAEkB;AACjB,UAAII,aAAa,GAAG;AAClBC,QAAAA,GAAG,EAAE,EADa;AAElBC,QAAAA,WAAW,EAAE;AAFK,OAApB;;AAKA,UAAI,KAAKC,cAAL,CAAoB,oBAApB,CAAJ,EAA+C;AAC7CH,QAAAA,aAAa,CAACI,QAAd,GAAyB,QAAzB;AACD;;AACD,UAAI,KAAKD,cAAL,CAAoB,kBAApB,CAAJ,EAA6C;AAC3CH,QAAAA,aAAa,CAACK,MAAd,GAAuB,QAAvB;AACD;;AAED,WAAKN,aAAL,GAAqBzG,cAArB,CAAoCgH,IAApC,CAAyCN,aAAzC;AACD;;;wCAEmBA,a,EAAe;AACjC,UAAIO,KAAK,GAAG,KAAKR,aAAL,GAAqBzG,cAAjC;AACAiH,MAAAA,KAAK,CAACZ,MAAN,CAAaY,KAAK,CAACC,OAAN,CAAcR,aAAd,CAAb,EAA2C,CAA3C;AACD;;;qCAEgB;AACf,UAAIS,IAAI,GAAG,8CAAX;AACA,WAAKC,YAAL,CAAkB,SAAlB,YAAgCD,IAAhC,kBAAmD,CAAnD;AACA,WAAKC,YAAL,CAAkB,eAAlB,YAAsCD,IAAtC,yBAAgE,CAAhE;AACA,WAAKC,YAAL,CAAkB,kBAAlB,YAAyCD,IAAzC,2BAAqE,CAArE;AACD;;;kCAEa;AACZ,WAAKb,SAAL;AACD;;;mCAEce,Q,EAAU;AACvB,UAAIA,QAAQ,IAAIA,QAAQ,CAAChI,MAAzB,EAAiC;AAAA,yBACDgI,QAAQ,CAAC,CAAD,CADP;AAAA,YACzB5I,IADyB,cACzBA,IADyB;AAAA,YACnB6I,OADmB,cACnBA,OADmB;AAAA,YACVC,IADU,cACVA,IADU;AAE/B,YAAIC,WAAW,GAAGF,OAAO,CAAC3C,GAAR,CAAY,UAAA8C,GAAG;AAAA,iBAAI,aAAa,OAAOA,GAApB,GAA0BA,GAA1B,GAAgCA,GAAG,CAACzD,IAAxC;AAAA,SAAf,CAAlB;AACAuD,QAAAA,IAAI,CAAC5C,GAAL,CACE,UAAA+C,GAAG;AAAA,iBAAI7E,MAAM,CAAC8E,MAAP,CAAcD,GAAd,EAAmB;AACxBE,YAAAA,SAAS,EAAEF,GAAG,CAACG,MAAJ,CACT,UAACC,KAAD,EAAQC,SAAR,EAAmBC,SAAnB;AAAA,qBAAiCnF,MAAM,CAAC8E,MAAP,CAAcG,KAAd,sBAAwBN,WAAW,CAACQ,SAAD,CAAnC,EAAiDD,SAAjD,EAAjC;AAAA,aADS,EAET,EAFS;AADa,WAAnB,CAAJ;AAAA,SADL;AAQA,aAAKzC,IAAL,GAAY;AACV7G,UAAAA,IAAI,EAAJA,IADU;AAEV6I,UAAAA,OAAO,EAAPA,OAFU;AAGVC,UAAAA,IAAI,EAAJA,IAHU;AAIVC,UAAAA,WAAW,EAAXA,WAJU;AAKVS,UAAAA,gBAAgB,EAAET,WAAW,CAACU,WAAZ,CAChB,UAACC,OAAD,EAAUC,OAAV,EAAmBC,KAAnB;AAAA,mBACExF,MAAM,CAAC8E,MAAP,CAAcQ,OAAd,sBAA0BC,OAA1B,EAAoCC,KAApC,EADF;AAAA,WADgB,EAGhB,EAHgB;AALR,SAAZ;AAWD,OAtBD,MAuBK;AACH,aAAK/C,IAAL,GAAY,EAAZ;AACD;;AAED,WAAKgB,SAAL;AACD;;;qCAEgBgC,G,EAAKrC,G,EAAK;AAAA;;AACzB,aAAO,UAAAsC,QAAQ,EAAI;AACjBD,QAAAA,GAAG,CAACrC,GAAD,CAAH,GAAWsC,QAAX;;AACA,QAAA,MAAI,CAACjC,SAAL;AACD,OAHD;AAID;;;gCAEW;AACV,WAAKd,MAAL,CAAYgD,IAAZ,CAAiB,WAAjB;AACD;;;qCAEwB;AAAA;;AAAA,wCAAPC,KAAO;AAAPA,QAAAA,KAAO;AAAA;;AACvB,aAAOA,KAAK,CAACC,KAAN,CAAY,UAAAvB,IAAI;AAAA,eAAI,CAACxE,eAAe,CAAC,MAAI,CAACmD,KAAL,CAAWrG,SAAZ,CAAf,IAAyC,EAA1C,EAA8CkJ,QAA9C,CAAuDxB,IAAvD,CAAJ;AAAA,OAAhB,CAAP;AACD;;;oCAEeA,I,EAAMpD,K,EAAO;AAC3B,UAAI+B,KAAK,GAAG,KAAKW,aAAL,EAAZ;;AACA,UAAI3H,gBAAEoH,GAAF,CAAMJ,KAAN,EAAaqB,IAAb,CAAJ,EAAwB;AACtBrI,wBAAE8J,GAAF,CAAM9C,KAAN,EAAaqB,IAAb,EAAmBpD,KAAnB;;AACA,aAAKuC,SAAL;AACD;AACF;;;oCAEe;AACd,aAAO,KAAKR,KAAL,CAAW,KAAKA,KAAL,CAAWrG,SAAtB,CAAP;AACD;;;gCAEWoJ,I,EAAM/C,K,EAAOgD,c,EAAgB;AAAA,UACjCb,gBADiC,GACZ,KAAK3C,IADO,CACjC2C,gBADiC;AAEvC,UAAIhC,GAAG,GAAG4C,IAAI,GAAG,YAAjB;AACA,UAAIE,UAAU,GAAG,CAACD,cAAD,IAAmBhD,KAAK,CAACG,GAAD,CAAL,IAAc+C,SAAlD;;AACA,UAAID,UAAU,IAAI,CAACjK,gBAAEoH,GAAF,CAAM+B,gBAAN,EAAwBnC,KAAK,CAACG,GAAD,CAA7B,CAAnB,EAAwD;AACtD,cAAM,IAAIgD,KAAJ,mBAAqBJ,IAArB,cAAN;AACD;;AACD,aAAOE,UAAU,GAAGd,gBAAgB,CAACnC,KAAK,CAACG,GAAD,CAAN,CAAnB,GAAkC,CAAC,CAApD;AACD;;;8BAESiD,C,EAAGC,K,EAAO;AAClB,UAAIC,KAAJ;AAAA,UACEC,OAAO,GAAG,KADZ;AAAA,UAEEC,IAAI,GAAG,IAFT;AAAA,UAGE7J,SAAS,GAAG6J,IAAI,CAACxD,KAAL,CAAWrG,SAHzB;AAAA,UAIE6F,IAAI,GAAGgE,IAAI,CAAChE,IAJd;AAAA,UAKEiE,QAAQ,GAAGJ,KAAK,CAACK,IAAN,CAAW,gBAAX,EAA6BC,GAA7B,CAAiC,UAAjC,EAA6C,UAA7C,EAAyDC,IAAzD,CAA8D,EAA9D,CALb;AAAA,UAMEC,WAAW,GAAGJ,QAAQ,CAAC,CAAD,CANxB;AAAA,UAOEK,OAAO,GAAGC,MAAM,CAAC,UAAD,CAAN,CAAmBC,QAAnB,CAA4BP,QAA5B,CAPZ;AAAA,UAQEQ,MAAM,GAAGH,OAAO,CAAC,CAAD,CARlB;;AAUA,UAAItE,IAAI,IAAIA,IAAI,CAACiC,IAAb,IAAqBjC,IAAI,CAACiC,IAAL,CAAUlI,MAAnC,EAA2C;AACzCuK,QAAAA,OAAO,CAACI,IAAR,CAAa;AAAEC,UAAAA,KAAK,EAAEV,QAAQ,CAACU,KAAT,EAAT;AAA2BC,UAAAA,MAAM,EAAEX,QAAQ,CAACW,MAAT;AAAnC,SAAb;;AACA,YAAI;AACF,cAAI,CAAC5E,IAAI,CAACkC,WAAV,EAAuB;AACrB,kBAAM,IAAIyB,KAAJ,CAAU,oCAAV,CAAN;AACD;;AAED,cAAI3D,IAAI,CAAC7G,IAAL,KAAc,OAAlB,EAA2B;AACzB,kBAAM,IAAIwK,KAAJ,CAAU,4BAAV,CAAN;AACD;;AAED,cAAI,UAAUxJ,SAAd,EAAyB;AACvB6J,YAAAA,IAAI,CAACa,YAAL,CAAkBJ,MAAlB;AACD,WAFD,MAGK,IAAI,aAAatK,SAAjB,EAA4B;AAC/B6J,YAAAA,IAAI,CAACc,eAAL,CAAqBL,MAArB;AACD,WAFI,MAGA,IAAI,UAAUtK,SAAd,EAAyB;AAC5B6J,YAAAA,IAAI,CAACe,YAAL,CAAkBN,MAAlB;AACD;;AACDV,UAAAA,OAAO,GAAG,IAAV;AACD,SAnBD,CAoBA,OAAOH,CAAP,EAAU;AACRoB,UAAAA,OAAO,CAAClB,KAAR,CAAc,YAAd,EAA4BA,KAAK,GAAGF,CAApC;AACD;AACF;;AACD,UAAI,CAACG,OAAL,EAAc;AACZ,YAAIkB,GAAG,GAAG,aAAanB,KAAK,GAAG,YAAYA,KAAK,CAACoB,OAArB,GAA+B,GAAjD,CAAV;;AACA,YAAIC,OAAO,GAAG1H,gBAAG2H,GAAH,CAAO;AACnB5L,UAAAA,CAAC,EAAE,KADgB;AACT6L,UAAAA,KAAK,EAAE;AAAEC,YAAAA,OAAO,EAAE,MAAX;AAAmBC,YAAAA,UAAU,EAAE,QAA/B;AAAyCC,YAAAA,SAAS,EAAE,QAApD;AAA8DZ,YAAAA,MAAM,EAAE;AAAtE,WADE;AAC8Ea,UAAAA,CAAC,EAAE,CAClG;AAAEjM,YAAAA,CAAC,EAAE,KAAL;AAAYkM,YAAAA,GAAG,EAAE,mBAAjB;AAAsCL,YAAAA,KAAK,EAAE;AAAEM,cAAAA,MAAM,EAAE;AAAV,aAA7C;AAAqEjH,YAAAA,IAAI,EAAEuG;AAA3E,WADkG;AADjF,SAAP,CAAd;;AAKAhB,QAAAA,QAAQ,CAACG,IAAT,CAAc,EAAd,EAAkBwB,MAAlB,CAAyBT,OAAzB;AACD;AACF;;;oCAEehL,S,EAAW;AACzB,UAAI6J,IAAI,GAAG,IAAX;AADyB,UAEnBhE,IAFmB,GAEVgE,IAFU,CAEnBhE,IAFmB;AAAA,UAGnBiC,IAHmB,GAGQjC,IAHR,CAGnBiC,IAHmB;AAAA,UAGbU,gBAHa,GAGQ3C,IAHR,CAGb2C,gBAHa;AAIzB,UAAIkD,SAAS,GAAG7B,IAAI,CAACxD,KAArB;AACA,UAAIA,KAAK,GAAGqF,SAAS,CAAC1L,SAAD,CAArB;AALyB,UAMnBU,WANmB,GAMiF2F,KANjF,CAMnB3F,WANmB;AAAA,UAMNE,YANM,GAMiFyF,KANjF,CAMNzF,YANM;AAAA,UAMQD,eANR,GAMiF0F,KANjF,CAMQ1F,eANR;AAAA,UAMyBF,OANzB,GAMiF4F,KANjF,CAMyB5F,OANzB;AAAA,UAMkCkC,SANlC,GAMiF0D,KANjF,CAMkC1D,SANlC;AAAA,UAM6C1B,SAN7C,GAMiFoF,KANjF,CAM6CpF,SAN7C;AAAA,UAMgE0K,YANhE,GAMiFtF,KANjF,CAMwD7E,MANxD;AAQzB,UAAIoK,gBAAgB,GAAG/B,IAAI,CAACgC,WAAL,CAAiB,UAAjB,EAA6BxF,KAA7B,CAAvB;AACA,UAAIyF,cAAc,GAAGzF,KAAK,CAACtD,OAAN,KAAkB,OAAlB,GAA4B,CAAC,CAA7B,GAAiC8G,IAAI,CAACgC,WAAL,CAAiB,QAAjB,EAA2BxF,KAA3B,EAAkC,IAAlC,CAAtD;AACA,UAAI0F,eAAe,GAAGlC,IAAI,CAACgC,WAAL,CAAiB,SAAjB,EAA4BxF,KAA5B,CAAtB;AACA,UAAI2F,aAAa,GAAGnC,IAAI,CAACgC,WAAL,CAAiB,OAAjB,EAA0BxF,KAA1B,EAAiC,IAAjC,CAApB;AACA,UAAI4F,aAAa,GAAGvL,WAAW,KAAK,QAAhB,GAA2BmJ,IAAI,CAACgC,WAAL,CAAiB,OAAjB,EAA0BxF,KAA1B,EAAiC,IAAjC,CAA3B,GAAoE,CAAC,CAAzF;AACA,UAAI6F,aAAa,GAAGrC,IAAI,CAACgC,WAAL,CAAiB,OAAjB,EAA0BxF,KAA1B,EAAiC,IAAjC,CAApB;AACA,UAAI8F,YAAY,GAAGL,cAAc,GAAG,CAApC;;AAEA,UAAIM,UAAU,GAAG/M,gBAAEgN,IAAF,CAAOvE,IAAI,CAAC5C,GAAL,CAAS,UAAA+C,GAAG;AAAA,eAAIA,GAAG,CAAC2D,gBAAD,CAAP;AAAA,OAAZ,CAAP,CAAjB;;AACA,UAAItE,MAAM,GAAGjI,gBAAEgN,IAAF,CAAOvE,IAAI,CAAC5C,GAAL,CAAS,UAAA+C,GAAG;AAAA,eAAIA,GAAG,CAAC6D,cAAD,CAAP;AAAA,OAAZ,CAAP,CAAb;;AACA,UAAI9L,SAAS,KAAK,KAAlB,EAAyB;AACvBoM,QAAAA,UAAU,CAACE,OAAX;AACAhF,QAAAA,MAAM,CAACgF,OAAP;AACD;;AAED,UAAIC,aAAa,GAAGH,UAAU,CAACxM,MAA/B;AACA,UAAI4M,WAAW,GAAGlF,MAAM,CAAC1H,MAAzB;AACA,UAAI6M,YAAY,GAAGF,aAAa,GAAGC,WAAnC;;AAzByB,yBA0BmC1E,IAAI,CAACM,MAAL,CAAY,UAACC,KAAD,EAAQJ,GAAR,EAAayE,QAAb,EAA0B;AAChG,YAAIC,WAAW,GAAGrF,MAAM,CAACG,OAAP,CAAeQ,GAAG,CAAC6D,cAAD,CAAlB,CAAlB;AACA,YAAIc,YAAY,GAAGR,UAAU,CAAC3E,OAAX,CAAmBQ,GAAG,CAAC2D,gBAAD,CAAtB,IAA4Ce,WAAW,GAAGJ,aAA7E;AACA,SAAClE,KAAK,CAACwE,QAAN,CAAeD,YAAf,IAA+BvE,KAAK,CAACwE,QAAN,CAAeD,YAAf,KAAgC,EAAhE,EAAoErF,IAApE,CAAyEU,GAAG,CAAC8D,eAAD,CAA5E;AACA,SAAC1D,KAAK,CAACyE,SAAN,CAAgBF,YAAhB,IAAgCvE,KAAK,CAACyE,SAAN,CAAgBF,YAAhB,KAAiC,EAAlE,EAAsErF,IAAtE,CAA2EU,GAA3E;AACAI,QAAAA,KAAK,CAAC7G,MAAN,CAAaoL,YAAb,IAA6BvE,KAAK,CAAC7G,MAAN,CAAaoL,YAAb,KAA8B3E,GAAG,CAAC+D,aAAD,CAA9D;AACA3D,QAAAA,KAAK,CAAC1B,MAAN,CAAaiG,YAAb,IAA6BvE,KAAK,CAAC1B,MAAN,CAAaiG,YAAb,KAA8B3E,GAAG,CAACgE,aAAD,CAA9D;AACA5D,QAAAA,KAAK,CAAC0E,YAAN,CAAmBJ,WAAnB,IAAkCtE,KAAK,CAAC0E,YAAN,CAAmBJ,WAAnB,KAAmC1E,GAAG,CAACiE,aAAD,CAAxE;AACA,eAAO7D,KAAP;AACD,OAT2D,EASzD;AAAEwE,QAAAA,QAAQ,EAAE,EAAZ;AAAgBrL,QAAAA,MAAM,EAAE,EAAxB;AAA4BmF,QAAAA,MAAM,EAAE,EAApC;AAAwCmG,QAAAA,SAAS,EAAE,EAAnD;AAAuDC,QAAAA,YAAY,EAAE;AAArE,OATyD,CA1BnC;AAAA,UA0BnBF,QA1BmB,gBA0BnBA,QA1BmB;AAAA,UA0BTrL,MA1BS,gBA0BTA,MA1BS;AAAA,UA0BDmF,MA1BC,gBA0BDA,MA1BC;AAAA,UA0BOmG,SA1BP,gBA0BOA,SA1BP;AAAA,UA0BkBC,YA1BlB,gBA0BkBA,YA1BlB;;AAqCzB,UAAIC,aAAa,GAAG7N,cAAc,CAAC8B,SAAD,CAAlC;;AACA,UAAI,CAAC+L,aAAL,EAAoB;AAClB,cAAM,IAAIxD,KAAJ,gCAAkCvI,SAAlC,EAAN;AACD;;AACD,WAAK,IAAIgM,CAAC,GAAGR,YAAb,EAA2BQ,CAAC,EAA5B,GAAkC;AAChCJ,QAAAA,QAAQ,CAACI,CAAD,CAAR,GAAcD,aAAa,CAACH,QAAQ,CAACI,CAAD,CAAR,IAAe,CAAC,CAAD,CAAhB,CAA3B;AACAH,QAAAA,SAAS,CAACG,CAAD,CAAT,GAAeH,SAAS,CAACG,CAAD,CAAT,IAAgB,EAA/B;AACD;;AAED,UAAIjN,SAAS,KAAK,QAAlB,EAA4B;AAC1B,YAAIkN,OAAO,GAAGL,QAAQ,CAAC3H,GAAT,CAAa,UAACiI,CAAD,EAAIF,CAAJ;AAAA,iBAAW;AAAEE,YAAAA,CAAC,EAADA,CAAF;AAAKF,YAAAA,CAAC,EAADA;AAAL,WAAX;AAAA,SAAb,EAAmCG,IAAnC,CAAwCzK,SAAS,KAAK,MAAd,GAAuB,UAAC0K,CAAD,EAAIC,CAAJ;AAAA,iBAAUA,CAAC,CAACH,CAAF,GAAME,CAAC,CAACF,CAAlB;AAAA,SAAvB,GAA6C,UAACE,CAAD,EAAIC,CAAJ;AAAA,iBAAUD,CAAC,CAACF,CAAF,GAAMG,CAAC,CAACH,CAAlB;AAAA,SAArF,EAA0GjI,GAA1G,CAA8G;AAAA,cAAG+H,CAAH,QAAGA,CAAH;AAAA,iBAAWA,CAAX;AAAA,SAA9G,CAAd;;AACA,YAAIM,KAAK,GAAG,SAARA,KAAQ,CAACJ,CAAD,EAAIF,CAAJ,EAAOI,CAAP;AAAA,iBAAaA,CAAC,CAACH,OAAO,CAACD,CAAD,CAAR,CAAd;AAAA,SAAZ;;AACAJ,QAAAA,QAAQ,GAAGA,QAAQ,CAAC3H,GAAT,CAAaqI,KAAb,CAAX;AACA/L,QAAAA,MAAM,GAAGA,MAAM,CAAC0D,GAAP,CAAWqI,KAAX,CAAT;AACA5G,QAAAA,MAAM,GAAGA,MAAM,CAACzB,GAAP,CAAWqI,KAAX,CAAT;AACAT,QAAAA,SAAS,GAAGA,SAAS,CAAC5H,GAAV,CAAcqI,KAAd,CAAZ;AACD;;AAED,UAAIC,UAAJ;AACA,UAAIC,gBAAgB,GAAG7M,YAAY,CAAChB,MAApC;;AAEA,UAAIc,WAAW,KAAK,QAApB,EAA8B;AAC5B,YAAI,CAACrB,gBAAEoH,GAAF,CAAM+B,gBAAN,EAAwB7H,eAAxB,CAAL,EAA+C;AAC7C,gBAAM,IAAI6I,KAAJ,CAAU,uBAAV,CAAN;AACD;;AACDgE,QAAAA,UAAU,GAAG7G,MAAM,CAACzB,GAAP,CAAW,UAAAQ,CAAC;AAAA,iBAAI,uBAAMA,CAAN,CAAJ;AAAA,SAAZ,CAAb;AACD,OALD,MAMK;AACH8H,QAAAA,UAAU,GAAG,EAAb;;AACA,YAAI9M,WAAW,KAAK,QAApB,EAA8B;AAC5B,cAAI,CAAC+M,gBAAL,EAAuB;AACrB,kBAAM,IAAIjE,KAAJ,CAAU,iCAAV,CAAN;AACD;;AACD5I,UAAAA,YAAY,GAAGA,YAAY,CAACsE,GAAb,CAAiB,UAAAQ,CAAC;AAAA,mBAAI,uBAAMA,CAAN,CAAJ;AAAA,WAAlB,CAAf;AACA4B,UAAAA,MAAM,CAACf,OAAP,CAAe,UAASmH,UAAT,EAAqBf,WAArB,EAAkC;AAC/CP,YAAAA,UAAU,CAAC7F,OAAX,CAAmB,UAASc,QAAT,EAAmBsG,aAAnB,EAAkC;AACnD,kBAAI/E,KAAK,GAAG+E,aAAa,GAAGhB,WAAW,GAAGJ,aAA1C;AACA,kBAAIqB,UAAU,GAAGnN,OAAO,KAAK,QAAZ,GAAuBkM,WAAvB,GAAqClM,OAAO,KAAK,MAAZ,GAAqBmI,KAArB,GAA6B+E,aAAnF;AACAH,cAAAA,UAAU,CAAC5E,KAAD,CAAV,GAAoBhI,YAAY,CAACgN,UAAU,GAAGH,gBAAd,CAAhC;AACD,aAJD;AAKD,WAND;AAOD,SAZD,MAaK;AACHnG,UAAAA,MAAM,CAACf,OAAP,CAAe,UAASmH,UAAT,EAAqBf,WAArB,EAAkC;AAC/CP,YAAAA,UAAU,CAAC7F,OAAX,CAAmB,UAASc,QAAT,EAAmBsG,aAAnB,EAAkC;AACnD,kBAAI/E,KAAK,GAAG+E,aAAa,GAAGhB,WAAW,GAAGJ,aAA1C;AACA,kBAAIqB,UAAU,GAAGnN,OAAO,KAAK,QAAZ,GAAuBkM,WAAvB,GAAqClM,OAAO,KAAK,MAAZ,GAAqBmI,KAArB,GAA6B+E,aAAnF;AACA,kBAAIE,UAAU,GAAGpN,OAAO,KAAK,QAAZ,GAAuB+L,WAAvB,GAAqC/L,OAAO,KAAK,MAAZ,GAAqBgM,YAArB,GAAoCF,aAA1F;AACAiB,cAAAA,UAAU,CAAC5E,KAAD,CAAV,GAAoBkF,kBAAMC,GAAN,CAAUC,IAAI,CAACC,KAAL,CAAW,MAAML,UAAN,GAAmBC,UAA9B,CAAV,EAAqD,CAArD,EAAwD,GAAxD,CAApB;AACD,aALD;AAMD,WAPD;AAQD;AACF,OAzFwB,CA2FzB;;;AACA,UAAIK,QAAQ,GAAGV,UAAU,CAACtI,GAAX,CAAe,UAAAiJ,KAAK;AAAA,eAAI,uBAAMA,KAAN,EAAad,CAAb,CAAehH,KAAK,CAACvF,gBAArB,EAAuCsN,IAAvC,EAAJ;AAAA,OAApB,CAAf;AACA,UAAIC,YAAY,GAAGb,UAAU,CAACtI,GAAX,CAAe,UAAAiJ,KAAK;AAAA,eAAI,uBAAMA,KAAN,EAAaG,CAAb,CAAejI,KAAK,CAACrF,oBAArB,EAA2CqM,CAA3C,CAA6ChH,KAAK,CAACtF,oBAAnD,EAAyEqN,IAAzE,EAAJ;AAAA,OAApB,CAAnB;;AAEA,eAASG,eAAT,CAAyBC,SAAzB,EAAoC1G,IAApC,EAA0CR,MAA1C,EAAkDD,QAAlD,EAA4DoH,OAA5D,EAAqE;AACnE,eAAOD,SAAS,CAACE,OAAV,CACL,uFADK,EAEL,UAAUC,KAAV,EAAiBC,eAAjB,EAAkCC,QAAlC,EAA4CC,UAA5C,EAAwDC,OAAxD,EAAiEC,SAAjE,EAA4E;AAC1E,cAAIJ,eAAJ,EAAqB;AACnBD,YAAAA,KAAK,GAAG,GAAR;AACD,WAFD,MAGK,IAAII,OAAJ,EAAa;AAChBA,YAAAA,OAAO,GAAGA,OAAO,CAACL,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAAV;;AACA,gBAAIrP,gBAAEoH,GAAF,CAAMqB,IAAI,CAAC,CAAD,CAAJ,CAAQK,SAAd,EAAyB4G,OAAzB,CAAJ,EAAuC;AACrCJ,cAAAA,KAAK,GAAG7G,IAAI,CAAC5C,GAAL,CAAS,UAAA+C,GAAG;AAAA,uBAAIA,GAAG,CAACE,SAAJ,CAAc4G,OAAd,CAAJ;AAAA,eAAZ,CAAR;AACAJ,cAAAA,KAAK,GAAGK,SAAS,KAAK,KAAd,GACJL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,uBAAUD,CAAC,GAAGC,CAAd;AAAA,eAAb,CADI,GAEJ0B,SAAS,KAAK,KAAd,GACEL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,uBAAUD,CAAC,GAAGC,CAAd;AAAA,eAAb,IAAgCqB,KAAK,CAAC/O,MADxC,GAEEoP,SAAS,KAAK,KAAd,GACEL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,uBAAUD,CAAC,GAAGC,CAAJ,GAAQD,CAAR,GAAYC,CAAtB;AAAA,eAAb,CADF,GAEE0B,SAAS,KAAK,KAAd,GACEL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,uBAAUD,CAAC,GAAGC,CAAJ,GAAQD,CAAR,GAAYC,CAAtB;AAAA,eAAb,CADF,GAEE0B,SAAS,KAAK,OAAd,GACEL,KAAK,CAAC,CAAD,CADP,GAEEK,SAAS,KAAK,MAAd,GACEL,KAAK,CAACA,KAAK,CAAC/O,MAAN,GAAe,CAAhB,CADP,GAEEoP,SAAS,KAAK,OAAd,GACEL,KAAK,CAAC/O,MADR,GAEEoP,SAAS,KAAK,cAAd,GACE,IAAIC,GAAJ,CAAQN,KAAR,EAAeO,IADjB,GAEEF,SAAS,KAAK,MAAd,GACEL,KAAK,CAACvB,IAAN,GAAahF,MAAb,CAAoB,UAACiF,CAAD,EAAIC,CAAJ,EAAO6B,CAAP,EAAUC,CAAV;AAAA,uBAAgB/B,CAAC,IAAI8B,CAAC,GAAG,CAAJ,KAAUC,CAAC,CAACxP,MAAZ,GAAqB,OAArB,GAA+B,IAAnC,CAAD,GAA4C0N,CAA5D;AAAA,eAApB,CADF,GAEE0B,SAAS,KAAK,aAAd,GACEK,KAAK,CAACC,IAAN,CAAW,IAAIL,GAAJ,CAAQN,KAAR,CAAX,EAA2BvB,IAA3B,GAAkChF,MAAlC,CAAyC,UAACiF,CAAD,EAAIC,CAAJ,EAAO6B,CAAP,EAAUC,CAAV;AAAA,uBAAgB/B,CAAC,IAAI8B,CAAC,GAAG,CAAJ,KAAUC,CAAC,CAACxP,MAAZ,GAAqB,OAArB,GAA+B,IAAnC,CAAD,GAA4C0N,CAA5D;AAAA,eAAzC,CADF,GAEEqB,KAAK,CAACY,IAAN,CAAW,GAAX,CApBtB;AAqBD;AACF,WA1BI,MA2BA;AACHZ,YAAAA,KAAK,GAAGE,QAAQ,GAAGvH,MAAH,GAAYwH,UAAU,GAAGzH,QAAH,GAAcoH,OAApD;AACD;;AACD,iBAAO,aAAa,OAAOE,KAApB,GACH,CAACA,KAAK,CAACa,OAAN,CAAc,CAAd,CADE,GAEHb,KAFJ;AAGD,SAvCI,CAAP;AAyCD;;AAED,eAASc,iBAAT,CAA2BC,aAA3B,EAAiE;AAAA,YAAvBC,SAAuB,uEAAX,SAAW;AAC/DA,QAAAA,SAAS,GAAGA,SAAS,CAACC,WAAV,EAAZ;AACA,YAAIC,UAAU,GAAGF,SAAS,KAAK,OAA/B;AACA,YAAIG,YAAY,GAAGH,SAAS,KAAK,SAAjC;;AACA,YAAI,EAAEE,UAAU,IAAIC,YAAhB,CAAJ,EAAmC;AACjC,gBAAM,IAAItG,KAAJ,kCAAoCmG,SAApC,EAAN;AACD;;AACD,eAAO,YAAY;AACjB,cAAIG,YAAJ,EAAkB;AAChB,gBAAIC,YAAY,GAAGC,SAAS,CAAC,CAAD,CAA5B;AACA,gBAAIC,UAAU,GAAGZ,KAAK,CAACa,OAAN,CAAcH,YAAd,CAAjB;;AAFgB,wBAG0CE,UAAU,GAAGF,YAAY,CAAC,CAAD,CAAf,GAAqBA,YAHzE;AAAA,gBAGIpD,WAHJ,SAGVwD,YAHU;AAAA,gBAGwBxC,aAHxB,SAGiB/E,KAHjB;AAIjB,WAJD,MAKK;AACH,gBAAIwH,SAAS,GAAGJ,SAAS,CAAC,CAAD,CAAzB;AACA,gBAAIC,UAAU,GAAG,KAAjB;AAFG,gBAGiBtD,WAHjB,GAG2DyD,SAH3D,CAGGD,YAHH;AAAA,gBAGyCxC,aAHzC,GAG2DyC,SAH3D,CAG8BC,SAH9B;AAIJ;;AACD,cAAIhJ,QAAQ,GAAG+E,UAAU,CAACuB,aAAD,CAAzB;AACA,cAAID,UAAU,GAAGpG,MAAM,CAACqF,WAAD,CAAvB;AACA,cAAIC,YAAY,GAAGe,aAAa,GAAGhB,WAAW,GAAGJ,aAAjD;AAEA,cAAIkC,OAAO,GAAG5B,QAAQ,CAACD,YAAD,CAAtB;AACA,cAAI9E,IAAI,GAAGgF,SAAS,CAACF,YAAD,CAApB;AAhBiB,cAiBX1L,YAjBW,GAiB4BmF,KAjB5B,CAiBXnF,YAjBW;AAAA,cAiBGC,oBAjBH,GAiB4BkF,KAjB5B,CAiBGlF,oBAjBH;AAAA,+BAkB4BkF,KAAK,CAACjF,OAlBlC;AAAA,cAkBXC,QAlBW,kBAkBXA,QAlBW;AAAA,cAkBDC,WAlBC,kBAkBDA,WAlBC;AAAA,cAkBYC,WAlBZ,kBAkBYA,WAlBZ;AAmBjB,cAAI+O,UAAU,GAAI,CAAC,CAAC,MAAD,EAAS,IAAT,EAAe,KAAK,CAApB,EAAuBpH,QAAvB,CAAgChI,YAAhC,CAAD,IAAkD,aAAa,OAAOuN,OAAvE,GACX,wBAAevN,YAAf,EAA6BuN,OAA7B,EAAsCtN,oBAAtC,EAA4D,IAA5D,CADW,GAEXsN,OAFN;AAGA,cAAID,SAAS,GAAG,CACdsB,YAAY,GACTzO,QAAQ,KAAK4O,UAAU,GAAG3O,WAAH,GAAiBC,WAAhC,CADC,GAEVoK,YAAY,CAACjK,MAHD,KAIXgO,aAJL;AAMA,cAAIa,SAAS,GAAG/B,SAAS,CAACE,OAAV,CACd,uFADc,EAEd,UAAUC,KAAV,EAAiBC,eAAjB,EAAkCC,QAAlC,EAA4CC,UAA5C,EAAwDC,OAAxD,EAAiEC,SAAjE,EAA4E;AAC1E,gBAAIJ,eAAJ,EAAqB;AACnBD,cAAAA,KAAK,GAAG,GAAR;AACD,aAFD,MAGK,IAAII,OAAJ,EAAa;AAChBA,cAAAA,OAAO,GAAGA,OAAO,CAACL,OAAR,CAAgB,QAAhB,EAA0B,IAA1B,CAAV;;AACA,kBAAIrP,gBAAEoH,GAAF,CAAMqB,IAAI,CAAC,CAAD,CAAJ,CAAQK,SAAd,EAAyB4G,OAAzB,CAAJ,EAAuC;AACrCJ,gBAAAA,KAAK,GAAG7G,IAAI,CAAC5C,GAAL,CAAS,UAAA+C,GAAG;AAAA,yBAAIA,GAAG,CAACE,SAAJ,CAAc4G,OAAd,CAAJ;AAAA,iBAAZ,CAAR;AACAJ,gBAAAA,KAAK,GAAGK,SAAS,KAAK,KAAd,GACJL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,yBAAUD,CAAC,GAAGC,CAAd;AAAA,iBAAb,CADI,GAEJ0B,SAAS,KAAK,KAAd,GACEL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,yBAAUD,CAAC,GAAGC,CAAd;AAAA,iBAAb,IAAgCqB,KAAK,CAAC/O,MADxC,GAEEoP,SAAS,KAAK,KAAd,GACEL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,yBAAUD,CAAC,GAAGC,CAAJ,GAAQD,CAAR,GAAYC,CAAtB;AAAA,iBAAb,CADF,GAEE0B,SAAS,KAAK,KAAd,GACEL,KAAK,CAACvG,MAAN,CAAa,UAACiF,CAAD,EAAIC,CAAJ;AAAA,yBAAUD,CAAC,GAAGC,CAAJ,GAAQD,CAAR,GAAYC,CAAtB;AAAA,iBAAb,CADF,GAEE0B,SAAS,KAAK,OAAd,GACEL,KAAK,CAAC,CAAD,CADP,GAEEK,SAAS,KAAK,MAAd,GACEL,KAAK,CAACA,KAAK,CAAC/O,MAAN,GAAe,CAAhB,CADP,GAEEoP,SAAS,KAAK,OAAd,GACEL,KAAK,CAAC/O,MADR,GAEEoP,SAAS,KAAK,cAAd,GACE,IAAIC,GAAJ,CAAQN,KAAR,EAAeO,IADjB,GAEEF,SAAS,KAAK,MAAd,GACEL,KAAK,CAACvB,IAAN,GAAahF,MAAb,CAAoB,UAACiF,CAAD,EAAIC,CAAJ,EAAO6B,CAAP,EAAUC,CAAV;AAAA,yBAAgB/B,CAAC,IAAI8B,CAAC,GAAG,CAAJ,KAAUC,CAAC,CAACxP,MAAZ,GAAqB,OAArB,GAA+B,IAAnC,CAAD,GAA4C0N,CAA5D;AAAA,iBAApB,CADF,GAEE0B,SAAS,KAAK,aAAd,GACEK,KAAK,CAACC,IAAN,CAAW,IAAIL,GAAJ,CAAQN,KAAR,CAAX,EAA2BvB,IAA3B,GAAkChF,MAAlC,CAAyC,UAACiF,CAAD,EAAIC,CAAJ,EAAO6B,CAAP,EAAUC,CAAV;AAAA,yBAAgB/B,CAAC,IAAI8B,CAAC,GAAG,CAAJ,KAAUC,CAAC,CAACxP,MAAZ,GAAqB,OAArB,GAA+B,IAAnC,CAAD,GAA4C0N,CAA5D;AAAA,iBAAzC,CADF,GAEE0B,SAAS,KAAK,WAAd,GACE1L,gBAAG8B,SAAH,CAAauJ,KAAK,CAAC,CAAD,CAAL,GAAW,EAAxB,CADF,GAEEK,SAAS,KAAK,WAAd,GACE,CAACL,KAAK,CAAC,CAAD,CAAL,GAAW,EAAZ,EAAgB6B,WAAhB,EADF,GAEExB,SAAS,KAAK,WAAd,GACE,CAACL,KAAK,CAAC,CAAD,CAAL,GAAW,EAAZ,EAAgBiB,WAAhB,EADF,GAEEjB,KAAK,CAACY,IAAN,CAAW,GAAX,CA1B5B;AA2BD;AACF,aAhCI,MAiCA;AACH;AACAZ,cAAAA,KAAK,GAAG,KAAK,CAACE,QAAQ,GAAGnB,UAAH,GAAgBoB,UAAU,GAAGzH,QAAH,GAAciJ,UAAjD,CAAb;AACD;;AACD,mBAAO,aAAa,OAAO3B,KAApB,GACH,CAACA,KAAK,CAACa,OAAN,CAAc,CAAd,CADE,GAEHb,KAFJ;AAGD,WA9Ca,KA+CX,EA/CL;AAiDA,iBAAOkB,UAAU,GACb,+BAASU,SAAT,EAAoB5E,YAAY,CAAC/J,SAAjC,CADa,GAEb2O,SAFJ;AAGD,SAhFD;AAiFD;;AAED,aAAO;AACL1G,QAAAA,IAAI,EAAJA,IADK;AAELhE,QAAAA,IAAI,EAAJA,IAFK;AAGLiC,QAAAA,IAAI,EAAJA,IAHK;AAILU,QAAAA,gBAAgB,EAAhBA,gBAJK;AAKLkD,QAAAA,SAAS,EAATA,SALK;AAMLrF,QAAAA,KAAK,EAALA,KANK;AAOLpF,QAAAA,SAAS,EAATA,SAPK;AAQL2K,QAAAA,gBAAgB,EAAhBA,gBARK;AASLE,QAAAA,cAAc,EAAdA,cATK;AAULC,QAAAA,eAAe,EAAfA,eAVK;AAWLC,QAAAA,aAAa,EAAbA,aAXK;AAYLC,QAAAA,aAAa,EAAbA,aAZK;AAaLC,QAAAA,aAAa,EAAbA,aAbK;AAcLa,QAAAA,YAAY,EAAZA,YAdK;AAeLZ,QAAAA,YAAY,EAAZA,YAfK;AAgBLC,QAAAA,UAAU,EAAVA,UAhBK;AAiBL9E,QAAAA,MAAM,EAANA,MAjBK;AAkBLiF,QAAAA,aAAa,EAAbA,aAlBK;AAmBLC,QAAAA,WAAW,EAAXA,WAnBK;AAoBLK,QAAAA,QAAQ,EAARA,QApBK;AAqBLJ,QAAAA,YAAY,EAAZA,YArBK;AAsBLjL,QAAAA,MAAM,EAANA,MAtBK;AAuBLsL,QAAAA,SAAS,EAATA,SAvBK;AAwBLU,QAAAA,UAAU,EAAVA,UAxBK;AAyBLU,QAAAA,QAAQ,EAARA,QAzBK;AA0BLG,QAAAA,YAAY,EAAZA,YA1BK;AA2BL1L,QAAAA,SAAS,EAATA,SA3BK;AA4BL8N,QAAAA,WAAW,EAAEhB,iBAAiB,CAAC,yBAAD,EAA4B,OAA5B,CA5BzB;AA6BLiB,QAAAA,gBAAgB,EAAE;AAChBC,UAAAA,KAAK,EAAElB,iBAAiB,CAAC,WAAD,CADR;AAEhBmB,UAAAA,KAAK,EAAEnB,iBAAiB,CAAC,yBAAD;AAFR,SA7Bb;AAiCLoB,QAAAA,cAjCK,0BAiCUpH,CAjCV,EAiCaqH,QAjCb,EAiCuB;AAC1B,cAAIC,IAAI,GAAG,KAAKC,iBAAL,CAAuBvH,CAAvB,EAA0B,CAA1B,CAAX;AACA,cAAIwH,MAAJ;;AACA,cAAIF,IAAJ,EAAU;AAAA,gBACapE,WADb,GACoDoE,IADpD,CACFG,aADE;AAAA,gBACkCvD,aADlC,GACoDoD,IADpD,CAC0BI,MAD1B;AAER,gBAAI9J,QAAQ,GAAG+E,UAAU,CAACuB,aAAD,CAAzB;AACA,gBAAID,UAAU,GAAGpG,MAAM,CAACqF,WAAD,CAAvB;AACAsE,YAAAA,MAAM,GAAG5K,KAAK,CAAC9F,cAAN,CAAqB6Q,IAArB,CAA0B,UAACnK,aAAD,EAAgBoK,kBAAhB,EAAuC;AACxE;AADwE,kBAElEnK,GAFkE,GAEhBD,aAFgB,CAElEC,GAFkE;AAAA,kBAEnDoK,WAFmD,GAEhBrK,aAFgB,CAE7DI,QAF6D;AAAA,kBAE9BkK,SAF8B,GAEhBtK,aAFgB,CAEtCK,MAFsC;;AAGxE,kBAAIJ,GAAJ,EAAS;AACP,oBAAI,kCAAYoK,WAAZ,EAAyB3N,IAAzB,CAA8B0D,QAA9B,MAA4C8E,YAAY,IAAI,kCAAYoF,SAAZ,EAAuB5N,IAAvB,CAA4B+J,UAA5B,CAA5D,CAAJ,EAA0G;AACxGoD,kBAAAA,QAAQ,CACNO,kBADM,EAENvE,SAAS,CAACa,aAAa,GAAGhB,WAAW,GAAGJ,aAA/B,CAFH,CAAR;AAIA,yBAAO,IAAP;AACD;AACF;AACF,aAZQ,CAAT;AAaD;;AAED,cAAI,CAAC0E,MAAL,EAAa;AACXH,YAAAA,QAAQ,CAAC,CAAC,CAAF,EAAK,EAAL,CAAR;AACD;AACF;AA1DI,OAAP;AA4DD;;;iCAEYxG,M,EAAQ;AAAA,kCAef,KAAKkH,eAAL,CAAqB,KAArB,CAfe;AAAA,UAEjB3H,IAFiB,yBAEjBA,IAFiB;AAAA,UAGjBxD,KAHiB,yBAGjBA,KAHiB;AAAA,UAIjB2F,aAJiB,yBAIjBA,aAJiB;AAAA,UAKjBC,aALiB,yBAKjBA,aALiB;AAAA,UAMjBG,UANiB,yBAMjBA,UANiB;AAAA,UAOjB9E,MAPiB,yBAOjBA,MAPiB;AAAA,UAQjBiF,aARiB,yBAQjBA,aARiB;AAAA,UASjBM,QATiB,yBASjBA,QATiB;AAAA,UAUjBqB,QAViB,yBAUjBA,QAViB;AAAA,UAWjBG,YAXiB,yBAWjBA,YAXiB;AAAA,UAYjBqC,gBAZiB,yBAYjBA,gBAZiB;AAAA,UAajBD,WAbiB,yBAajBA,WAbiB;AAAA,UAcjBI,cAdiB,yBAcjBA,cAdiB;;AAiBnB,UAAIY,QAAQ,GAAGnK,MAAM,CAACpC,GAAP,CAAW,UAACwI,UAAD,EAAaf,WAAb,EAA6B;AACrD,YAAI+E,QAAQ,GAAG,SAAXA,QAAW,CAACjD,OAAD,EAAU7B,YAAV;AAAA,iBAA2B,CAAC,EAAEA,YAAY,GAAGL,aAAjB,CAAD,KAAqCI,WAAhE;AAAA,SAAf;;AACA,eAAO;AACLiE,UAAAA,KAAK,EAAExE,UADF;AAELvG,UAAAA,IAAI,EAAEgH,QAAQ,CAAC8E,MAAT,CAAgBD,QAAhB,CAFD;AAGLlR,UAAAA,WAAW,EAAE6F,KAAK,CAAC7F,WAHd;AAILoR,UAAAA,WAAW,EAAEvD,YAAY,CAACsD,MAAb,CAAoBD,QAApB,CAJR;AAKLG,UAAAA,eAAe,EAAE3D,QAAQ,CAACyD,MAAT,CAAgBD,QAAhB,CALZ;AAMLI,UAAAA,UAAU,EAAE;AACVC,YAAAA,MAAM,EAAE,QADE;AAEV5G,YAAAA,OAAO,EAAE,MAFC;AAGV0G,YAAAA,eAAe,EAAE,uBAAMxL,KAAK,CAAC7E,MAAN,CAAaG,WAAb,GAA2B,OAA3B,GAAqC,OAA3C,EAAoD0L,CAApD,CAAsD,IAAtD,EAA4De,IAA5D,EAHP;AAIVD,YAAAA,KAAK,EAAE,uBAAM9H,KAAK,CAAC7E,MAAN,CAAaG,WAAb,GAA2B,OAA3B,GAAqC,OAA3C,EAAoDqQ,GAApD,EAJG;AAKVC,YAAAA,YAAY,EAAE,CALJ;AAMVC,YAAAA,SAAS,EAAEzB,WAND;AAOVpF,YAAAA,SAAS,EAAE;AAPD;AANP,SAAP;AAgBD,OAlBc,CAAf;AAoBA,UAAI8G,WAAW,GAAG;AAChBC,QAAAA,UAAU,EAAE,IADI;AAEhBvM,QAAAA,IAAI,EAAE;AACJ4L,UAAAA,QAAQ,EAARA,QADI;AAEJjQ,UAAAA,MAAM,EAAEiQ,QAAQ,CAAC,CAAD,CAAR,CAAYb;AAFhB,SAFU;AAMhByB,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAE,CAACjM,KAAK,CAACrD,YAAN,GAAqB,CAArB,GAAyB,CAA1B,IAA+BgL,IAAI,CAACuE,EAD5C;AAEPC,UAAAA,QAAQ,EAAE,CAACxE,IAAI,CAACuE,EAAN,IAAYlM,KAAK,CAACrD,YAAN,GAAqB,CAArB,GAAyB,CAArC,CAFH;AAGPyP,UAAAA,QAAQ,EAAE;AAAEjS,YAAAA,WAAW,EAAE6F,KAAK,CAAC7F;AAArB,WAHH;AAIPkS,UAAAA,QAAQ,EAAE;AACRC,YAAAA,SAAS,EAAEjC;AADH,WAJH;AAOP7O,UAAAA,MAAM,EAAE;AACNsJ,YAAAA,OAAO,EAAE9E,KAAK,CAACxE,MAAN,CAAaJ,SADhB;AAENK,YAAAA,QAAQ,EAAEuE,KAAK,CAACxE,MAAN,CAAaC,QAFjB;AAGN8Q,YAAAA,SAAS,EAAEvM,KAAK,CAACxE,MAAN,CAAaE,WAHlB;AAINuK,YAAAA,OAAO,EAAEjG,KAAK,CAACxE,MAAN,CAAaG,SAJhB;AAKNR,YAAAA,MAAM,EAAE;AACNqR,cAAAA,SAAS,EAAEhU,cAAc,GAAG,MAAH,GAAY;AAD/B;AALF,WAPD;AAgBPiU,UAAAA,SAAS,EAAE;AACTC,YAAAA,YAAY,EAAE,IADL;AAETC,YAAAA,aAAa,EAAE;AAFN,WAhBJ;AAoBPC,UAAAA,OAAO,EAAE,iBAAUxJ,CAAV,EAAa;AACpBoH,YAAAA,cAAc,CAACqC,IAAf,CAAoB,IAApB,EAA0BzJ,CAA1B,EAA6B,UAAC4H,kBAAD,EAAqB8B,YAArB,EAAsC;AACjE,kBAAI9B,kBAAkB,IAAI,CAA1B,EAA6B;AAC3BxH,gBAAAA,IAAI,CAACuJ,iBAAL,CAAuB/M,KAAK,CAAC9F,cAAN,CAAqB8Q,kBAArB,CAAvB,EAAiE8B,YAAjE;AACD;AACF,aAJD;AAKD,WA1BM;AA2BPE,UAAAA,KAAK,EAAE;AACLC,YAAAA,OAAO,EAAE,iBAAU7J,CAAV,EAAa;AACpBoH,cAAAA,cAAc,CAACqC,IAAf,CAAoB,IAApB,EAA0BzJ,CAA1B,EAA6B,UAAC4H,kBAAD,EAAqB8B,YAArB,EAAsC;AACjE1J,gBAAAA,CAAC,CAAC8J,MAAF,CAASrI,KAAT,CAAesI,MAAf,GAAwBnC,kBAAkB,IAAI,CAAtB,GAA0B,SAA1B,GAAsC,SAA9D;AACD,eAFD;AAGD;AALI;AA3BA;AANO,OAAlB;;AA2CA,UAAI3N,kBAAJ,EAAwB;AACtByO,QAAAA,WAAW,CAACE,OAAZ,CAAoBS,SAApB,GAAgC,KAAhC;AACD;;AAED,UAAIzM,KAAK,CAAC7E,MAAN,CAAaC,SAAjB,EAA4B;AAC1B0Q,QAAAA,WAAW,CAACsB,OAAZ,GAAsB,CAACC,eAAD,CAAtB;AACD;;AAED,UAAIC,GAAG,GAAGrJ,MAAM,CAACsJ,UAAP,CAAkB,IAAlB,CAAV;;AACA,UAAIvN,KAAK,CAACtD,OAAN,KAAkB,OAAtB,EAA+B;AAC7B8Q,QAAAA,KAAK,CAACC,SAAN,CAAgBH,GAAhB,EAAqBxB,WAArB;AACD,OAFD,MAGK;AACHA,QAAAA,WAAW,CAACnT,IAAZ,GAAmBqH,KAAK,CAACtD,OAAN,KAAkB,UAAlB,GAA+B,UAA/B,GAA4C,KAA/D;AACA,YAAI8Q,KAAJ,CAAUF,GAAV,EAAexB,WAAf;AACD;AACF;;;iCAEY7H,M,EAAQ;AAAA,mCAgBf,KAAKkH,eAAL,CAAqB,KAArB,CAhBe;AAAA,UAEjB3H,IAFiB,0BAEjBA,IAFiB;AAAA,UAGjBxD,KAHiB,0BAGjBA,KAHiB;AAAA,UAIjB0G,YAJiB,0BAIjBA,YAJiB;AAAA,UAKjBZ,YALiB,0BAKjBA,YALiB;AAAA,UAMjBC,UANiB,0BAMjBA,UANiB;AAAA,UAOjB9E,MAPiB,0BAOjBA,MAPiB;AAAA,UAQjBiF,aARiB,0BAQjBA,aARiB;AAAA,UASjBM,QATiB,0BASjBA,QATiB;AAAA,UAUjBC,SAViB,0BAUjBA,SAViB;AAAA,UAWjBoB,QAXiB,0BAWjBA,QAXiB;AAAA,UAYjBG,YAZiB,0BAYjBA,YAZiB;AAAA,UAajBqC,gBAbiB,0BAajBA,gBAbiB;AAAA,UAcjBD,WAdiB,0BAcjBA,WAdiB;AAAA,UAejBI,cAfiB,0BAejBA,cAfiB,EAkBnB;;;AACA,UAAIxR,gBAAEoH,GAAF,CAAMJ,KAAN,EAAa,CAAC,cAAD,EAAiB,CAAjB,EAAoB,MAApB,CAAb,CAAJ,EAA+C;AAC7CA,QAAAA,KAAK,CAACzF,YAAN,GAAqByF,KAAK,CAACzF,YAAN,CAAmBsE,GAAnB,CAAuB,UAAAiJ,KAAK;AAAA,iBAAIA,KAAK,CAACA,KAAV;AAAA,SAA5B,CAArB;AACA9H,QAAAA,KAAK,CAAC3F,WAAN,GAAoB,QAApB;AACD;;AAED,UAAI+Q,QAAQ,GAAGnK,MAAM,CAACpC,GAAP,CAAW,UAACwI,UAAD,EAAaf,WAAb,EAA6B;AACrD,YAAI+E,QAAQ,GAAG,SAAXA,QAAW,CAACjD,OAAD,EAAU7B,YAAV;AAAA,iBAA2B,CAAC,EAAEA,YAAY,GAAGL,aAAjB,CAAD,KAAqCI,WAAhE;AAAA,SAAf;;AACA,eAAO;AACLiE,UAAAA,KAAK,EAAElD,UADF;AAEL7H,UAAAA,IAAI,EAAEgH,QAAQ,CAAC8E,MAAT,CAAgBD,QAAhB,CAFD;AAGLlR,UAAAA,WAAW,EAAE6F,KAAK,CAAC7F,WAHd;AAILoR,UAAAA,WAAW,EAAEvD,YAAY,CAACsD,MAAb,CAAoBD,QAApB,CAJR;AAKLG,UAAAA,eAAe,EAAE3D,QAAQ,CAACyD,MAAT,CAAgBD,QAAhB,CALZ;AAMLqC,UAAAA,KAAK,EAAE1N,KAAK,CAACxF,SAAN,GAAkBkM,YAAY,CAACJ,WAAD,CAA9B,GAA8CA,WANhD;AAOLmF,UAAAA,UAAU,EAAE;AACVC,YAAAA,MAAM,EAAE,QADE;AAEV5G,YAAAA,OAAO,EAAE,MAFC;AAGV0G,YAAAA,eAAe,EAAE,uBAAMxL,KAAK,CAAC7E,MAAN,CAAaG,WAAb,GAA2B,OAA3B,GAAqC,OAA3C,EAAoD0L,CAApD,CAAsD,IAAtD,EAA4De,IAA5D,EAHP;AAIVD,YAAAA,KAAK,EAAE,uBAAM9H,KAAK,CAAC7E,MAAN,CAAaG,WAAb,GAA2B,OAA3B,GAAqC,OAA3C,EAAoDqQ,GAApD,EAJG;AAKVC,YAAAA,YAAY,EAAE,CALJ;AAMVC,YAAAA,SAAS,EAAEzB,WAND;AAOVpF,YAAAA,SAAS,EAAE;AAPD;AAPP,SAAP;AAiBD,OAnBc,CAAf;AAqBA,UAAI8G,WAAW,GAAG;AAChBnT,QAAAA,IAAI,EAAEqH,KAAK,CAACnG,WAAN,KAAsB,YAAtB,GAAqC,eAArC,GAAuD,KAD7C;AAEhB2F,QAAAA,IAAI,EAAE;AACJ4L,UAAAA,QAAQ,EAARA,QADI;AAEJjQ,UAAAA,MAAM,EAAE4K;AAFJ,SAFU;AAMhB;AACAiG,QAAAA,OAAO,EAAE;AACPD,UAAAA,UAAU,EAAE,IADL;AAEPM,UAAAA,QAAQ,EAAE;AACRsB,YAAAA,IAAI,EAAE,OADE;AAERrB,YAAAA,SAAS,EAAEjC;AAFH,WAFH;AAMP7O,UAAAA,MAAM,EAAE;AACNsJ,YAAAA,OAAO,EAAE9E,KAAK,CAACxE,MAAN,CAAaJ,SADhB;AAENK,YAAAA,QAAQ,EAAEuE,KAAK,CAACxE,MAAN,CAAaC,QAFjB;AAGN8Q,YAAAA,SAAS,EAAEvM,KAAK,CAACxE,MAAN,CAAaE,WAHlB;AAINuK,YAAAA,OAAO,EAAEjG,KAAK,CAACxE,MAAN,CAAaG,SAJhB;AAKNR,YAAAA,MAAM,EAAE;AACNqR,cAAAA,SAAS,EAAEhU,cAAc,GAAG,MAAH,GAAY;AAD/B;AALF,WAND;AAePoD,UAAAA,MAAM,EAAE;AACNC,YAAAA,KAAK,EAAE,CACL;AACEC,cAAAA,KAAK,EAAE;AACLC,gBAAAA,QAAQ,EAAEiE,KAAK,CAACpE,MAAN,CAAaC,KAAb,CAAmBC,KAAnB,CAAyBC,QAD9B;AAELC,gBAAAA,WAAW,EAAEgE,KAAK,CAACpE,MAAN,CAAaC,KAAb,CAAmBC,KAAnB,CAAyBE,WAFjC;AAGLC,gBAAAA,WAAW,EAAE+D,KAAK,CAACpE,MAAN,CAAaC,KAAb,CAAmBC,KAAnB,CAAyBG,WAHjC;AAILuQ,gBAAAA,SAAS,EAAEhU,cAAc,GAAG,MAAH,GAAY,MAJhC;AAKLoV,gBAAAA,YAAY,EAAE,sBAAU3P,KAAV,EAAiBsE,KAAjB,EAAwBsL,MAAxB,EAAgC;AAAA,sBACtChT,YADsC,GACCmF,KADD,CACtCnF,YADsC;AAAA,sBACxBC,oBADwB,GACCkF,KADD,CACxBlF,oBADwB;AAE5C,yBAAQ,CAAC,CAAC,MAAD,EAAS,IAAT,EAAe,KAAK,CAApB,EAAuB+H,QAAvB,CAAgChI,YAAhC,CAAD,IAAkD,aAAa,OAAOoD,KAAvE,GACH,wBAAepD,YAAf,EAA6BoD,KAA7B,EAAoCnD,oBAApC,EAA0D,IAA1D,CADG,GAEHmD,KAFJ;AAGD;AAVI,eADT;AAaE6P,cAAAA,OAAO,EAAE,IAbX;AAcEC,cAAAA,SAAS,EAAE;AACTjJ,gBAAAA,OAAO,EAAE,CAAC,CAAC9E,KAAK,CAACpE,MAAN,CAAaC,KAAb,CAAmBK,eADrB;AAET4L,gBAAAA,KAAK,EAAEtP,cAAc,wBAAiB,CAACwH,KAAK,CAACpE,MAAN,CAAaC,KAAb,CAAmBK,eAArC,oCAA8E,CAAC8D,KAAK,CAACpE,MAAN,CAAaC,KAAb,CAAmBK,eAAlG;AAFZ;AAdb,aADK,CADD;AAsBNC,YAAAA,KAAK,EAAE,CACL;AACEL,cAAAA,KAAK,EAAE;AACLC,gBAAAA,QAAQ,EAAEiE,KAAK,CAACpE,MAAN,CAAaO,KAAb,CAAmBL,KAAnB,CAAyBC,QAD9B;AAELC,gBAAAA,WAAW,EAAEgE,KAAK,CAACpE,MAAN,CAAaO,KAAb,CAAmBL,KAAnB,CAAyBE,WAFjC;AAGLC,gBAAAA,WAAW,EAAE+D,KAAK,CAACpE,MAAN,CAAaO,KAAb,CAAmBL,KAAnB,CAAyBG,WAHjC;AAILuQ,gBAAAA,SAAS,EAAEhU,cAAc,GAAG,MAAH,GAAY,MAJhC;AAKLoV,gBAAAA,YAAY,EAAE,sBAAU3P,KAAV,EAAiBsE,KAAjB,EAAwBsL,MAAxB,EAAgC;AAAA,sBACtChT,YADsC,GACCmF,KADD,CACtCnF,YADsC;AAAA,sBACxBC,oBADwB,GACCkF,KADD,CACxBlF,oBADwB;AAE5C,yBAAQ,CAAC,CAAC,MAAD,EAAS,IAAT,EAAe,KAAK,CAApB,EAAuB+H,QAAvB,CAAgChI,YAAhC,CAAD,IAAkD,aAAa,OAAOoD,KAAvE,GACH,wBAAepD,YAAf,EAA6BoD,KAA7B,EAAoCnD,oBAApC,EAA0D,IAA1D,CADG,GAEHmD,KAFJ;AAGD;AAVI,eADT;AAaE6P,cAAAA,OAAO,EAAE,IAbX;AAcEC,cAAAA,SAAS,EAAE;AACTjJ,gBAAAA,OAAO,EAAE,CAAC,CAAC9E,KAAK,CAACpE,MAAN,CAAaO,KAAb,CAAmBD,eADrB;AAET4L,gBAAAA,KAAK,EAAEtP,cAAc,wBAAiB,CAACwH,KAAK,CAACpE,MAAN,CAAaO,KAAb,CAAmBD,eAArC,oCAA8E,CAAC8D,KAAK,CAACpE,MAAN,CAAaO,KAAb,CAAmBD,eAAlG;AAFZ;AAdb,aADK;AAtBD,WAfD;AA2DP0Q,UAAAA,OAAO,EAAE,iBAAUxJ,CAAV,EAAa;AACpBoH,YAAAA,cAAc,CAACqC,IAAf,CAAoB,IAApB,EAA0BzJ,CAA1B,EAA6B,UAAC4H,kBAAD,EAAqB8B,YAArB,EAAsC;AACjE,kBAAI9B,kBAAkB,IAAI,CAA1B,EAA6B;AAC3BxH,gBAAAA,IAAI,CAACuJ,iBAAL,CAAuB/M,KAAK,CAAC9F,cAAN,CAAqB8Q,kBAArB,CAAvB,EAAiE8B,YAAjE;AACD;AACF,aAJD;AAKD,WAjEM;AAkEPE,UAAAA,KAAK,EAAE;AACLC,YAAAA,OAAO,EAAE,iBAAU7J,CAAV,EAAa;AACpBoH,cAAAA,cAAc,CAACqC,IAAf,CAAoB,IAApB,EAA0BzJ,CAA1B,EAA6B,UAAC4H,kBAAD,EAAqB8B,YAArB,EAAsC;AACjE1J,gBAAAA,CAAC,CAAC8J,MAAF,CAASrI,KAAT,CAAesI,MAAf,GAAwBnC,kBAAkB,IAAI,CAAtB,GAA0B,SAA1B,GAAsC,SAA9D;AACD,eAFD;AAGD;AALI;AAlEA;AAPO,OAAlB;;AAmFA,UAAI3N,kBAAJ,EAAwB;AACtByO,QAAAA,WAAW,CAACE,OAAZ,CAAoBS,SAApB,GAAgC,KAAhC;AACD;;AAED,UAAIzM,KAAK,CAAC7E,MAAN,CAAaC,SAAjB,EAA4B;AAC1B0Q,QAAAA,WAAW,CAACsB,OAAZ,GAAsB,CAACC,eAAD,CAAtB;AACD;;AAED,UAAIW,OAAO,GAAG,IAAIR,KAAJ,CAAUvJ,MAAM,CAACsJ,UAAP,CAAkB,IAAlB,CAAV,EAAmCzB,WAAnC,CAAd;AACD;;;oCAEe7H,M,EAAQ;AAAA,mCAelB,KAAKkH,eAAL,CAAqB,QAArB,CAfkB;AAAA,UAEpB3H,IAFoB,0BAEpBA,IAFoB;AAAA,UAGpBxD,KAHoB,0BAGpBA,KAHoB;AAAA,UAIpB8F,YAJoB,0BAIpBA,YAJoB;AAAA,UAKpBC,UALoB,0BAKpBA,UALoB;AAAA,UAMpB9E,MANoB,0BAMpBA,MANoB;AAAA,UAOpBiF,aAPoB,0BAOpBA,aAPoB;AAAA,UAQpBM,QARoB,0BAQpBA,QARoB;AAAA,UASpBC,SAToB,0BASpBA,SAToB;AAAA,UAUpBoB,QAVoB,0BAUpBA,QAVoB;AAAA,UAWpBG,YAXoB,0BAWpBA,YAXoB;AAAA,UAYpBqC,gBAZoB,0BAYpBA,gBAZoB;AAAA,UAapBD,WAboB,0BAapBA,WAboB;AAAA,UAcpBI,cAdoB,0BAcpBA,cAdoB;;AAiBtB,UAAIyD,OAAO,GAAG;AACZ1D,QAAAA,KAAK,EAAExE,UADK;AAEZvG,QAAAA,IAAI,EAAEgH,QAFM;AAGZrM,QAAAA,WAAW,EAAE,CAHD;AAIZoR,QAAAA,WAAW,EAAEvD,YAJD;AAKZwD,QAAAA,eAAe,EAAE3D,QALL;AAMZ4D,QAAAA,UAAU,EAAEzL,KAAK,CAAC7E,MAAN,GACR;AACAuQ,UAAAA,MAAM,EAAE,QADR;AAEA5G,UAAAA,OAAO,EAAE,MAFT;AAGA0G,UAAAA,eAAe,EAAE,uBAAMxL,KAAK,CAAC7E,MAAN,CAAaG,WAAb,GAA2B,OAA3B,GAAqC,OAA3C,EAAoD0L,CAApD,CAAsD,IAAtD,EAA4De,IAA5D,EAHjB;AAIAD,UAAAA,KAAK,EAAE,uBAAM9H,KAAK,CAAC7E,MAAN,CAAaG,WAAb,GAA2B,OAA3B,GAAqC,OAA3C,EAAoDqQ,GAApD,EAJP;AAKAC,UAAAA,YAAY,EAAE,CALd;AAMAC,UAAAA,SAAS,EAAEzB,WANX;AAOApF,UAAAA,SAAS,EAAE;AAPX,SADQ,GAUR;AAhBQ,OAAd;AAmBA,UAAI8G,WAAW,GAAG;AAChBnT,QAAAA,IAAI,EAAE,QADU;AAEhBoT,QAAAA,UAAU,EAAE,IAFI;AAGhBvM,QAAAA,IAAI,EAAE;AACJ4L,UAAAA,QAAQ,EAAE,CAAE6C,OAAF,CADN;AAEJ9S,UAAAA,MAAM,EAAE,aAAa,OAAO8S,OAAO,CAAC1D,KAA5B,GACJ0D,OAAO,CAACzO,IAAR,CAAaX,GAAb,CAAiB,UAACQ,CAAD,EAAIuH,CAAJ;AAAA,6BAAaqH,OAAO,CAAC1D,KAArB,eAA+B3D,CAAC,GAAG,CAAnC;AAAA,WAAjB,CADI,GAEJqH,OAAO,CAAC1D;AAJR,SAHU;AAShByB,QAAAA,OAAO,EAAE;AACPkC,UAAAA,iBAAiB,EAAElO,KAAK,CAACxD,aADlB;AAEPuK,UAAAA,IAAI,EAAE/G,KAAK,CAAC1D,SAFL;AAGP8P,UAAAA,QAAQ,EAAE;AAAEjS,YAAAA,WAAW,EAAE6F,KAAK,CAAC7F;AAArB,WAHH;AAIPoC,UAAAA,GAAG,EAAEyD,KAAK,CAACzD,GAJJ;AAKP4R,UAAAA,IAAI,EAAE,iBAAiB7Q,IAAjB,CAAsB0C,KAAK,CAAC3D,MAAN,IAAgB,EAAtC,IAA4C2D,KAAK,CAAC3D,MAAlD,GAA2D,MAL1D;AAMPgQ,UAAAA,QAAQ,EAAE;AACRC,YAAAA,SAAS,EAAEjC;AADH,WANH;AASP7O,UAAAA,MAAM,EAAE;AACNsJ,YAAAA,OAAO,EAAE9E,KAAK,CAACxE,MAAN,CAAaJ,SADhB;AAENK,YAAAA,QAAQ,EAAEuE,KAAK,CAACxE,MAAN,CAAaC,QAFjB;AAGN8Q,YAAAA,SAAS,EAAEvM,KAAK,CAACxE,MAAN,CAAaE,WAHlB;AAINuK,YAAAA,OAAO,EAAEjG,KAAK,CAACxE,MAAN,CAAaG,SAJhB;AAKNR,YAAAA,MAAM,EAAE;AACNqR,cAAAA,SAAS,EAAEhU,cAAc,GAAG,MAAH,GAAY;AAD/B;AALF,WATD;AAkBPiU,UAAAA,SAAS,EAAE;AACTC,YAAAA,YAAY,EAAE,IADL;AAETC,YAAAA,aAAa,EAAE;AAFN,WAlBJ;AAsBPC,UAAAA,OAAO,EAAE,iBAAUxJ,CAAV,EAAa;AACpBoH,YAAAA,cAAc,CAACqC,IAAf,CAAoB,IAApB,EAA0BzJ,CAA1B,EAA6B,UAAC4H,kBAAD,EAAqB8B,YAArB,EAAsC;AACjE,kBAAI9B,kBAAkB,IAAI,CAA1B,EAA6B;AAC3BxH,gBAAAA,IAAI,CAACuJ,iBAAL,CAAuB/M,KAAK,CAAC9F,cAAN,CAAqB8Q,kBAArB,CAAvB,EAAiE8B,YAAjE;AACD;AACF,aAJD;AAKD,WA5BM;AA6BPE,UAAAA,KAAK,EAAE;AACLC,YAAAA,OAAO,EAAE,iBAAU7J,CAAV,EAAa;AACpBoH,cAAAA,cAAc,CAACqC,IAAf,CAAoB,IAApB,EAA0BzJ,CAA1B,EAA6B,UAAC4H,kBAAD,EAAqB8B,YAArB,EAAsC;AACjE1J,gBAAAA,CAAC,CAAC8J,MAAF,CAASrI,KAAT,CAAesI,MAAf,GAAwBnC,kBAAkB,IAAI,CAAtB,GAA0B,SAA1B,GAAsC,SAA9D;AACD,eAFD;AAGD;AALI;AA7BA;AATO,OAAlB;;AAgDA,UAAI3N,kBAAJ,EAAwB;AACtByO,QAAAA,WAAW,CAACE,OAAZ,CAAoBS,SAApB,GAAgC,KAAhC;AACD,OAtFqB,CAwFtB;AACA;AACA;;;AAEA,UAAIuB,OAAO,GAAG,IAAIR,KAAJ,CAAUvJ,MAAM,CAACsJ,UAAP,CAAkB,IAAlB,CAAV,EAAmCzB,WAAnC,CAAd;AACD;;;sCAEiBlL,a,EAAekM,Y,EAAc;AAAA,UAC/B3K,gBAD+B,GAC6B,IAD7B,CACvC3C,IADuC,CAC/B2C,gBAD+B;AAAA,UACIiM,SADJ,GAC6B,IAD7B,CACXC,WADW,CACID,SADJ;AAAA,UACiBE,OADjB,GAC6B,IAD7B,CACiBA,OADjB;AAAA,UAEvCzN,GAFuC,GAElBD,aAFkB,CAEvCC,GAFuC;AAAA,UAElCC,WAFkC,GAElBF,aAFkB,CAElCE,WAFkC;AAG7CD,MAAAA,GAAG,GAAGA,GAAG,CAACwH,OAAJ,CAAYxP,sBAAZ,EAAoC,MAApC,EAA4CwP,OAA5C,CACJzP,oBADI,EAEJ,UAAU0P,KAAV,EAAiBiG,MAAjB,EAAyBC,YAAzB,EAAuC7V,IAAvC,EAA6CoK,IAA7C,EAAmD0L,KAAnD,EAA0DC,OAA1D,EAAmEC,SAAnE,EAA8E;AAC5E,YAAIJ,MAAJ,EAAY;AAAA,sCACSD,OAAO,CAACM,eAAR,EADT;AAAA,cACJ3F,IADI,yBACJA,IADI;AAAA,cACE4F,EADF,yBACEA,EADF;;AAEV,iBAAO,CAACL,YAAY,IAAI,IAAhB,GAAuB,UAAUM,kBAAkB,CAAC7F,IAAD,CAAnD,GAA4D,EAA7D,KACFuF,YAAY,GAAG,EAAH,GAAQ,GADlB,KAEFA,YAAY,IAAI,MAAhB,GAAyB,QAAQM,kBAAkB,CAACD,EAAD,CAAnD,GAA0D,EAFxD,CAAP;AAGD;;AAED9L,QAAAA,IAAI,GAAGA,IAAI,IAAIA,IAAI,CAACsF,OAAL,CAAa,QAAb,EAAuB,IAAvB,CAAf;AACAsG,QAAAA,SAAS,GAAGA,SAAS,IAAIA,SAAS,CAACtG,OAAV,CAAkB,QAAlB,EAA4B,IAA5B,CAAzB;;AACA,YAAI0G,MAAM,GAAG/V,gBAAEgN,IAAF,CACXrN,IAAI,IAAI,KAAR,GACImU,YAAY,CAACjO,GAAb,CAAiB,UAAA+C,GAAG;AAAA,iBAAIA,GAAG,CAACO,gBAAgB,CAACY,IAAD,CAAjB,CAAP;AAAA,SAApB,CADJ,GAEIqL,SAAS,CAACrM,MAAV,CACA,UAAC8L,MAAD,EAASmB,QAAT,EAAsB;AACpB;AACA,cAAIC,SAAS,GAAGhS,gBAAGiS,OAAH,CAAWF,QAAQ,CAACG,OAAT,CAAiBlR,KAA5B,CAAhB;;AACA,cAAImR,KAAK,GAAGJ,QAAQ,CAACK,UAAT,IAAuBJ,SAAS,CAAC1V,MAAV,KAAqB,CAA5C,IAAiD0V,SAAS,CAAC,CAAD,CAAT,KAAiB,QAA9E;AACA,iBAAOD,QAAQ,CAACjM,IAAT,KAAkBA,IAAlB,GACH8K,MAAM,CAACjP,MAAP,CAAcwQ,KAAK,GAAG,CAACJ,QAAQ,CAACG,OAAT,CAAiBjR,IAAlB,CAAH,GAA6B+Q,SAAhD,CADG,GAEHpB,MAFJ;AAGD,SARD,EASA,EATA,CAHO,CAAb;;AAeA,eAAOkB,MAAM,CAACxV,MAAP,GAAgB,CAAhB,GACH+O,KADG,GAEHmG,KAAK,GACHM,MAAM,CAAC7F,IAAP,CAAY,GAAZ,CADG,GAEHwF,OAAO,GACLK,MAAM,CAAClQ,GAAP,CAAW,UAAAiI,CAAC;AAAA,iBAAIgI,kBAAkB,CAACH,SAAS,IAAIzL,SAAb,GAAyBvK,IAAI,KAAK,KAAT,iBAAwBoK,IAAxB,IAAiCA,IAA1D,GAAiE4L,SAAlE,CAAlB,GAAiG,GAAjG,GAAuGG,kBAAkB,CAAChI,CAAD,CAA7H;AAAA,SAAZ,EAA8IoC,IAA9I,CAAmJ,GAAnJ,CADK,GAEL4F,kBAAkB,CAACC,MAAM,CAAC7F,IAAP,CAAY,GAAZ,CAAD,CAN1B;AAOD,OAlCG,CAAN;AAoCAoG,MAAAA,MAAM,CAACC,IAAP,CAAY1O,GAAZ,EAAiBD,aAAa,CAACE,WAAd,GAA4B,QAA5B,GAAuC,OAAxD;AACD;;;+BAEU;AACT,aAAO9H,gBAAEoG,KAAF,CAAQoQ,KAAR,CAAc,IAAd,EAAoB7F,SAApB,CAAP;AACD;;;yBAEI8F,K,EAAO/E,I,EAAMgF,K,EAAOlM,I,EAAM;AAAA;;AAC7B,WAAK9D,MAAL,CAAYC,EAAZ,CAAe,WAAf,EAA4B,UAAAyD,CAAC;AAAA,eAAI,MAAI,CAACuM,SAAL,CAAe9C,IAAf,CAAoB,MAApB,EAA0BzJ,CAA1B,EAA6BsH,IAA7B,CAAJ;AAAA,OAA7B;AACA,WAAKhL,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB3G,gBAAE4W,QAAF,CAAW,UAAAxM,CAAC;AAAA,eAAI,MAAI,CAACuM,SAAL,CAAe9C,IAAf,CAAoB,MAApB,EAA0BzJ,CAA1B,EAA6BsH,IAA7B,CAAJ;AAAA,OAAZ,EAAoD,GAApD,CAAzB;AACD;;;;EA18BmCmF,qB,GA68BtC;;;;AACArC,KAAK,CAACJ,OAAN,CAAc0C,UAAd,CAAyBzC,eAAzB;AAEA1P,gBAAgB,CAACoS,WAAjB,GAA+B,sBAA/B","sourcesContent":["import { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport { getValueFormat, getValueFormats } from '@grafana/ui';\nimport config from 'app/core/config';\nimport _ from 'lodash';\n\nimport JS from './external/YourJS.min';\nimport * as Chart from './external/Chart.bundle.min';\nimport * as ChartDataLabels from './external/Chart.datalabels.plugin';\nimport './external/Chart.funnel';\nimport { Color } from './external/CWest-Color.min';\n\nimport { parseRegExp, wrapText } from './helper-functions';\n\nconst IS_LIGHT_THEME = config.theme.type === 'light'\n\nconst RGX_CELL_PLACEHOLDER = /\\$\\{(time)(?:-(to|from))?\\}|\\$\\{(col|var):((?:[^\\}:\\\\]*|\\\\.)+)(?::(?:(raw)|(param)(?::((?:[^\\}:\\\\]*|\\\\.)+))?))?\\}/g;\nconst RGX_OLD_VAR_WORKAROUND = /([\\?&])var-(\\$\\{var:(?:[^\\}:\\\\]*|\\\\.)+:param\\})/g;\n\nconst COUNT_TYPE_MAP = {\n  sum: _.sum,\n  avg: _.mean,\n  min: _.min,\n  max: _.max,\n  count: arr => arr.length,\n  first: arr => arr[0],\n  last: arr => arr[arr.length - 1],\n};\n\nconst PANEL_DEFAULTS = {\n  chartType: null\n};\n\nconst BAR_DEFAULTS = {\n  orientation: 'vertical',\n  categoryColumnName: null,\n  seriesColumnName: null,\n  stackColumnName: null,\n  measureColumnName: null,\n  drilldownLinks: [],\n  borderWidth: 1,\n  colorBy: 'series',\n  colorSource: 'auto',\n  colorColumnName: null,\n  seriesColors: [],\n  isStacked: false,\n  dataBgColorAlpha: 0.75,\n  dataBorderColorAlpha: 1,\n  dataBorderBrightness: 0.5,\n  countType: 'sum',\n  numberFormat: 'none',\n  numberFormatDecimals: 0,\n  tooltip: {\n    isCustom: false,\n    titleFormat:  null,\n    labelFormat: null\n  },\n  labels: {\n    isShowing: false,\n    format: '${measure}',\n    isBlackText: IS_LIGHT_THEME,\n    wrapAfter: 25\n  },\n  legend: {\n    isShowing: true,\n    position: 'top',\n    isFullWidth: false,\n    isReverse: false\n  },\n  scales: {\n    xAxes: {\n      ticks: {\n        autoSkip: true,\n        minRotation: 0,\n        maxRotation: 90\n      },\n      gridLineOpacity: 0.15\n    },\n    yAxes: {\n      ticks: {\n        autoSkip: true,\n        minRotation: 0,\n        maxRotation: 90\n      },\n      gridLineOpacity: 0.15\n    }\n  }\n};\n\nconst FUNNEL_DEFAULTS = {\n  hAlign: 'center',\n  sortOrder: 'desc',\n  categoryColumnName: null,\n  measureColumnName: null,\n  drilldownLinks: [],\n  borderWidth: 1,\n  colorSource: 'auto',\n  colorColumnName: null,\n  seriesColors: [],\n  dataBgColorAlpha: 0.75,\n  dataBorderColorAlpha: 1,\n  dataBorderBrightness: 0.5,\n  countType: 'sum',\n  numberFormat: 'none',\n  numberFormatDecimals: 0,\n  tooltip: {\n    isCustom: false,\n    titleFormat:  null,\n    labelFormat: null\n  },\n  // labels: {\n  //   isShowing: false,\n  //   format: '${measure}',\n  //   isBlackText: IS_LIGHT_THEME,\n  //   wrapAfter: 25\n  // },\n  gap: 1,\n  startWidthPct: 0.5,\n  legend: {\n    isShowing: true,\n    position: 'top',\n    isFullWidth: false,\n    isReverse: false\n  }\n};\n\nconst PIE_DEFAULTS = {\n  pieType: 'pie',\n  isSemiCircle: false,\n  categoryColumnName: null,\n  seriesColumnName: null,\n  measureColumnName: null,\n  labelColumnName: null,\n  drilldownLinks: [],\n  borderWidth: 1,\n  colorBy: 'both',\n  colorSource: 'auto',\n  colorColumnName: null,\n  seriesColors: [],\n  dataBgColorAlpha: 0.75,\n  dataBorderBrightness: 0.5,\n  dataBorderColorAlpha: 1,\n  countType: 'sum',\n  numberFormat: 'none',\n  numberFormatDecimals: 0,\n  tooltip: {\n    isCustom: false,\n    titleFormat:  null,\n    labelFormat: null\n  },\n  labels: {\n    isShowing: false,\n    format: '${measure}',\n    isBlackText: IS_LIGHT_THEME,\n    wrapAfter: 25\n  },\n  legend: {\n    isShowing: true,\n    position: 'top',\n    isFullWidth: false,\n    isReverse: false\n  }\n};\n\nconst OPTIONS_BY_TYPE = {\n  bar: Object.keys(JS.flattenKeys(BAR_DEFAULTS, true)),\n  pie: Object.keys(JS.flattenKeys(PIE_DEFAULTS, true)),\n  funnel: Object.keys(JS.flattenKeys(FUNNEL_DEFAULTS, true))\n};\n\nconst DISABLE_ANIMATIONS = !/^(0|[Ff]alse|[Oo]ff|[Nn]o|)$/.test([JS.parseQS(location.href).__noanimation] + '');\n\nexport class ChartJsPanelCtrl extends MetricsPanelCtrl {\n  constructor($scope, $injector, $rootScope) {\n    super($scope, $injector);\n    \n    this.UNIT_FORMATS = getValueFormats();\n    this.GRID_LINE_OPACITIES = [\n      { value: false, text: 'None' },\n      { value: 0.15, text: 'Light' },\n      { value: 0.65, text: 'Dark' }\n    ];\n    this.CHART_START_WIDTH_PERCENTAGES = [\n      { value: 0, text: '0% (Point)' },\n      { value: 0.25, text: '25%' },\n      { value: 0.5, text: '50% (Half)' },\n      { value: 0.75, text: '75%' },\n      { value: 1, text: '100% (Full)' }\n    ];\n    this.CHART_BORDER_WIDTHS = [\n      { value: 0, text: '0px (NO BORDER)' },\n      { value: 1, text: '1px' },\n      { value: 2, text: '2px' },\n      { value: 3, text: '3px' }\n    ];\n    this.CHART_GAP_SIZES = [\n      { value: 0, text: '0px (NO GAP)' },\n      { value: 1, text: '1px' },\n      { value: 2, text: '2px' },\n      { value: 3, text: '3px' },\n      { value: 4, text: '4px' },\n      { value: 5, text: '5px' }\n    ];\n    this.CHART_COLOR_BY = [\n      { value: 'series', text: 'Series' },\n      { value: 'category', text: 'Category' },\n      { value: 'both', text: 'Series & Category' }\n    ];\n    this.CHART_COLOR_SOURCES = [\n      { value: 'column', text: 'Column' },\n      { value: 'auto', text: 'Rainbow' },\n      { value: 'custom', text: 'User-defined' }\n    ];\n    this.CHART_LABEL_SOURCES = [\n      { value: null, text: 'None' },\n      { value: 'column', text: 'Column' },\n      { value: 'custom', text: 'User-defined' }\n    ];\n    this.CHART_TYPES = [\n      { value: null, 'text': '--- PICK ONE ---' },\n      { value: 'bar', text: 'Bar' },\n      { value: 'funnel', text: 'Funnel' },\n      { value: 'pie', text: 'Pie' }\n    ];\n    this.PIE_TYPES = [\n      { value: null, 'text': '--- PICK ONE ---' },\n      { value: 'pie', text: 'Default' },\n      { value: 'polar', text: 'Polar' },\n      { value: 'doughnut', text: 'Doughnut' }\n    ];\n    this.COUNT_TYPES = [{ value: null, text: '--- PICK ONE ---' }].concat(\n      Object.keys(COUNT_TYPE_MAP).map(t => ({ value: t, text: JS.titleCase(t) }))\n    );\n    this.CHART_ORIENTATIONS = [\n      { value: 'horizontal', text: 'Horizontal (\\u2194)' },\n      { value: 'vertical', text: 'Vertical (\\u2195)' }\n    ];\n    this.CHART_H_ALIGNMENTS = [\n      { value: 'left', text: 'Left' },\n      { value: 'center', text: 'Center' },\n      { value: 'right', text: 'Right' }\n    ];\n    this.SORT_ORDERS = [\n      { value: 'asc', text: 'Ascending' },\n      { value: 'desc', text: 'Descending' }\n    ];\n    this.COLOR_ALPHAS = _.range(0, 101, 5).map(x => ({\n      value: x / 100, text: `${x}%` + (x ? x === 100 ? ' (Solid)' : '' : ' (Invisible)')\n    }));\n    this.BRIGHTNESSES = _.range(0, 101, 5).map(x => ({\n      value: x / 100, text: `${x}%` + (x ? x === 100 ? ' (White)' : '' : ' (Black)')\n    }));\n    this.TICK_ROTATIONS = _.range(0, 91, 5).map(x => ({\n      value: x, text: `${x}\\xB0` + (x ? x === 90 ? ' (Vertical)' : '' : ' (Horizontal)')\n    }));\n\n    this.$rootScope = $rootScope;\n    this.data = null;\n\n    this.setPanelDefaults();\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n  }\n\n  // Setup the appropriate defaults and make sure that any old bar chart data\n  // is migrated to the new structure.\n  setPanelDefaults() {\n    let panel = this.panel;\n    _.defaultsDeep(panel, PANEL_DEFAULTS);\n    switch (panel.chartType) {\n      case 'horizontalBar':\n        panel.chartType = 'bar';\n        panel.orientation = 'horizontal';\n      case 'bar':\n        if (!panel.bar) {\n          panel.bar = {};\n        }\n        _.defaultsDeep(panel.bar, BAR_DEFAULTS);\n        Object.keys(BAR_DEFAULTS).forEach(key => {\n          if (_.has(panel, key)) {\n            panel.bar[key] = panel[key];\n            delete panel[key];\n          }\n        });\n        break;\n\n      case 'funnel':\n        _.defaultsDeep(panel.funnel = panel.funnel || {}, FUNNEL_DEFAULTS);\n        break;\n\n      case 'pie':\n        _.defaultsDeep(panel.pie = panel.pie || {}, PIE_DEFAULTS);\n        break;\n    }\n  }\n\n  addSeriesColor(opt_index) {\n    let panel = this.panel;\n    let colors = panel[panel.chartType].seriesColors;\n    colors.splice(opt_index == null ? colors.length : opt_index, 0, Color('black') + '');\n    this.renderNow();\n  }\n\n  moveSeriesColor(fromIndex, toIndex) {\n    let colors = this.getChartPanel().seriesColors;\n    colors.splice(toIndex, 0, colors.splice(fromIndex, 1)[0]);\n    this.renderNow();\n  }\n\n  removeSeriesColor(opt_index) {\n    let panel = this.panel;\n    let colors = panel[panel.chartType].seriesColors;\n    let count = colors.length;\n    if (count) {\n      colors.splice(opt_index == null ? count - 1 : opt_index, 1);\n      this.renderNow();\n    }\n  }\n\n  addDrilldownLink() {\n    let drilldownLink = {\n      url: '',\n      openInBlank: true\n    };\n\n    if (this.isActiveOption('categoryColumnName')) {\n      drilldownLink.category = '/[^]*/';\n    }\n    if (this.isActiveOption('seriesColumnName')) {\n      drilldownLink.series = '/[^]*/';\n    }\n\n    this.getChartPanel().drilldownLinks.push(drilldownLink);\n  }\n\n  removeDrilldownLink(drilldownLink) {\n    let links = this.getChartPanel().drilldownLinks;\n    links.splice(links.indexOf(drilldownLink), 1);\n  }\n\n  onInitEditMode() {\n    let path = 'public/plugins/westc-chartjs-panel/partials/';\n    this.addEditorTab('Options', `${path}editor.html`, 2);\n    this.addEditorTab('Series Colors', `${path}series-colors.html`, 3);\n    this.addEditorTab('Drill-down Links', `${path}drilldown-links.html`, 4);\n  }\n\n  onDataError() {\n    this.renderNow();\n  }\n\n  onDataReceived(dataList) {\n    if (dataList && dataList.length) {\n      let { type, columns, rows } = dataList[0];\n      let columnTexts = columns.map(col => 'string' === typeof col ? col : col.text);\n      rows.map(\n        row => Object.assign(row, {\n          byColName: row.reduce(\n            (carry, cellValue, cellIndex) => Object.assign(carry, { [columnTexts[cellIndex]]: cellValue }),\n            {}\n          )\n        })\n      );\n      this.data = {\n        type,\n        columns,\n        rows,\n        columnTexts,\n        colIndexesByText: columnTexts.reduceRight(\n          (indexes, colText, index) =>\n            Object.assign(indexes, { [colText]: index }),\n          {}\n        )\n      };\n    }\n    else {\n      this.data = {};\n    }\n\n    this.renderNow();\n  }\n\n  onChangeCallback(obj, key) {\n    return newValue => {\n      obj[key] = newValue;\n      this.renderNow();\n    };\n  }\n\n  renderNow() {\n    this.events.emit('renderNow');\n  }\n\n  isActiveOption(...paths) {\n    return paths.every(path => (OPTIONS_BY_TYPE[this.panel.chartType] || []).includes(path));\n  }\n\n  setActiveOption(path, value) {\n    let panel = this.getChartPanel();\n    if (_.has(panel, path)) {\n      _.set(panel, path, value);\n      this.renderNow();\n    }\n  }\n\n  getChartPanel() {\n    return this.panel[this.panel.chartType];\n  }\n\n  getColIndex(name, panel, opt_isOptional) {\n    let { colIndexesByText } = this.data;\n    let key = name + 'ColumnName';\n    let isRequired = !opt_isOptional || panel[key] != undefined;\n    if (isRequired && !_.has(colIndexesByText, panel[key])) {\n      throw new Error(`Invalid ${name} column.`);\n    }\n    return isRequired ? colIndexesByText[panel[key]] : -1;\n  }\n\n  drawChart(e, jElem) {\n    let error,\n      isValid = false,\n      ctrl = this,\n      chartType = ctrl.panel.chartType,\n      data = ctrl.data,\n      jContent = jElem.find('.panel-content').css('position', 'relative').html(''),\n      elemContent = jContent[0],\n      jCanvas = jQuery('<canvas>').appendTo(jContent),\n      canvas = jCanvas[0];\n\n    if (data && data.rows && data.rows.length) {\n      jCanvas.prop({ width: jContent.width(), height: jContent.height() });\n      try {\n        if (!data.columnTexts) {\n          throw new Error('No source data has been specified.');\n        }\n\n        if (data.type !== 'table') {\n          throw new Error('Data type must be \"table\".');\n        }\n\n        if ('bar' === chartType) {\n          ctrl.drawBarChart(canvas);\n        }\n        else if ('funnel' === chartType) {\n          ctrl.drawFunnelChart(canvas);\n        }\n        else if ('pie' === chartType) {\n          ctrl.drawPieChart(canvas);\n        }\n        isValid = true;\n      }\n      catch (e) {\n        console.error('drawChart:', error = e);\n      }\n    }\n    if (!isValid) {\n      let msg = 'No data' + (error ? ':  \\r\\n' + error.message : '.');\n      let elemMsg = JS.dom({\n        _: 'div', style: { display: 'flex', alignItems: 'center', textAlign: 'center', height: '100%' }, $: [\n          { _: 'div', cls: 'alert alert-error', style: { margin: '0px auto' }, text: msg }\n        ]\n      });\n      jContent.html('').append(elemMsg);\n    }\n  }\n\n  getChartOptions(chartType) {\n    let ctrl = this;\n    let { data } = ctrl;\n    let { rows, colIndexesByText } = data;\n    let fullPanel = ctrl.panel;\n    let panel = fullPanel[chartType];\n    let { colorSource, seriesColors, colorColumnName, colorBy, sortOrder, countType, labels: labelOptions } = panel;\n\n    let categoryColIndex = ctrl.getColIndex('category', panel);\n    let seriesColIndex = panel.pieType === 'polar' ? -1 : ctrl.getColIndex('series', panel, true);\n    let measureColIndex = ctrl.getColIndex('measure', panel);\n    let labelColIndex = ctrl.getColIndex('label', panel, true);\n    let colorColIndex = colorSource === 'column' ? ctrl.getColIndex('color', panel, true) : -1;\n    let stackColIndex = ctrl.getColIndex('stack', panel, true);\n    let ignoreSeries = seriesColIndex < 0;\n\n    let categories = _.uniq(rows.map(row => row[categoryColIndex]));\n    let series = _.uniq(rows.map(row => row[seriesColIndex]));\n    if (chartType === 'pie') {\n      categories.reverse();\n      series.reverse();\n    }\n\n    let categoryCount = categories.length;\n    let seriesCount = series.length;\n    let measureCount = categoryCount * seriesCount;\n    let { measures, labels, colors, rowGroups, seriesStacks } = rows.reduce((carry, row, rowIndex) => {\n      let seriesIndex = series.indexOf(row[seriesColIndex]);\n      let measureIndex = categories.indexOf(row[categoryColIndex]) + seriesIndex * categoryCount;\n      (carry.measures[measureIndex] = carry.measures[measureIndex] || []).push(row[measureColIndex]);\n      (carry.rowGroups[measureIndex] = carry.rowGroups[measureIndex] || []).push(row);\n      carry.labels[measureIndex] = carry.labels[measureIndex] || row[labelColIndex];\n      carry.colors[measureIndex] = carry.colors[measureIndex] || row[colorColIndex];\n      carry.seriesStacks[seriesIndex] = carry.seriesStacks[seriesIndex] || row[stackColIndex];\n      return carry;\n    }, { measures: [], labels: [], colors: [], rowGroups: [], seriesStacks: [] });\n\n    let countMeasures = COUNT_TYPE_MAP[countType];\n    if (!countMeasures) {\n      throw new Error(`Unknown count type:\\t${countType}`);\n    }\n    for (let i = measureCount; i--; ) {\n      measures[i] = countMeasures(measures[i] || [0]);\n      rowGroups[i] = rowGroups[i] || [];\n    }\n\n    if (chartType === 'funnel') {\n      let sortMap = measures.map((v, i) => ({ v, i })).sort(sortOrder === 'desc' ? (a, b) => b.v - a.v : (a, b) => a.v - b.v).map(({ i }) => i);\n      let remap = (v, i, a) => a[sortMap[i]];\n      measures = measures.map(remap);\n      labels = labels.map(remap);\n      colors = colors.map(remap);\n      rowGroups = rowGroups.map(remap);\n    }\n\n    let baseColors;\n    let seriesColorCount = seriesColors.length;\n\n    if (colorSource === 'column') {\n      if (!_.has(colIndexesByText, colorColumnName)) {\n        throw new Error('Invalid color column.');\n      }\n      baseColors = colors.map(x => Color(x));\n    }\n    else {\n      baseColors = [];\n      if (colorSource === 'custom') {\n        if (!seriesColorCount) {\n          throw new Error('No base colors have been added.');\n        }\n        seriesColors = seriesColors.map(x => Color(x));\n        series.forEach(function(seriesName, seriesIndex) {\n          categories.forEach(function(category, categoryIndex) {\n            let index = categoryIndex + seriesIndex * categoryCount;\n            let colorIndex = colorBy === 'series' ? seriesIndex : colorBy === 'both' ? index : categoryIndex;\n            baseColors[index] = seriesColors[colorIndex % seriesColorCount];\n          });\n        });\n      }\n      else {\n        series.forEach(function(seriesName, seriesIndex) {\n          categories.forEach(function(category, categoryIndex) {\n            let index = categoryIndex + seriesIndex * categoryCount;\n            let colorIndex = colorBy === 'series' ? seriesIndex : colorBy === 'both' ? index : categoryIndex;\n            let colorCount = colorBy === 'series' ? seriesCount : colorBy === 'both' ? measureCount : categoryCount;\n            baseColors[index] = Color.hsl(Math.round(360 * colorIndex / colorCount), 1, 0.5);\n          });\n        });\n      }\n    }\n\n    // Derive the background and border colors from the base colors.\n    let bgColors = baseColors.map(color => Color(color).a(panel.dataBgColorAlpha).rgba());\n    let borderColors = baseColors.map(color => Color(color).l(panel.dataBorderBrightness).a(panel.dataBorderColorAlpha).rgba());\n\n    function formatLabelText(strFormat, rows, series, category, measure) {\n      return strFormat.replace(\n        /(\\\\\\$)|\\$\\{(?:(series)|(category)|measure|col:((?:[^\\\\\\}:]+|\\\\.)+)(?::([\\-\\w]+))?)\\}/g,\n        function (match, isEscapedDollar, isSeries, isCategory, colName, colFnName) {\n          if (isEscapedDollar) {\n            match = '$';\n          }\n          else if (colName) {\n            colName = colName.replace(/\\\\(.)/g, '$1');\n            if (_.has(rows[0].byColName, colName)) {\n              match = rows.map(row => row.byColName[colName]);\n              match = colFnName === 'sum'\n                ? match.reduce((a, b) => a + b)\n                : colFnName === 'avg'\n                  ? match.reduce((a, b) => a + b) / match.length\n                  : colFnName === 'max'\n                    ? match.reduce((a, b) => a > b ? a : b)\n                    : colFnName === 'min'\n                      ? match.reduce((a, b) => a < b ? a : b)\n                      : colFnName === 'first'\n                        ? match[0]\n                        : colFnName === 'last'\n                          ? match[match.length - 1]\n                          : colFnName === 'count'\n                            ? match.length\n                            : colFnName === 'unique-count'\n                              ? new Set(match).size\n                              : colFnName === 'list'\n                                ? match.sort().reduce((a, b, c, d) => a + (c + 1 === d.length ? ' and ' : ', ') + b)\n                                : colFnName === 'unique-list'\n                                  ? Array.from(new Set(match)).sort().reduce((a, b, c, d) => a + (c + 1 === d.length ? ' and ' : ', ') + b)\n                                  : match.join(',');\n            }\n          }\n          else {\n            match = isSeries ? series : isCategory ? category : measure;\n          }\n          return 'number' === typeof match\n            ? +match.toFixed(5)\n            : match;\n        }\n      )\n    }\n\n    function getLabelFormatter(defaultFormat, labelType = 'tooltip') {\n      labelType = labelType.toLowerCase();\n      let isForChart = labelType === 'chart';\n      let isForTooltip = labelType === 'tooltip';\n      if (!(isForChart || isForTooltip)) {\n        throw new Error(`Unknown label format:\\t${labelType}`);\n      }\n      return function () {\n        if (isForTooltip) {\n          let tooltipItems = arguments[0];\n          var isForTitle = Array.isArray(tooltipItems);\n          var { datasetIndex: seriesIndex, index: categoryIndex } = isForTitle ? tooltipItems[0] : tooltipItems;\n        }\n        else {\n          let labelItem = arguments[1];\n          var isForTitle = false;\n          var { datasetIndex: seriesIndex, dataIndex: categoryIndex } = labelItem;\n        }\n        let category = categories[categoryIndex];\n        let seriesName = series[seriesIndex];\n        let measureIndex = categoryIndex + seriesIndex * categoryCount;\n\n        let measure = measures[measureIndex];\n        let rows = rowGroups[measureIndex];\n        let { numberFormat, numberFormatDecimals } = panel;\n        let { isCustom, titleFormat, labelFormat } = panel.tooltip;\n        let strMeasure = (!['none', null, void 0].includes(numberFormat) && 'number' === typeof measure)\n            ? getValueFormat(numberFormat)(measure, numberFormatDecimals, null)\n            : measure;\n        let strFormat = (\n          isForTooltip\n          ? (isCustom && (isForTitle ? titleFormat : labelFormat))\n          : labelOptions.format\n        ) || defaultFormat;\n\n        let strResult = strFormat.replace(\n          /(\\\\\\$)|\\$\\{(?:(series)|(category)|measure|col:((?:[^\\\\\\}:]+|\\\\.)+)(?::([\\-\\w]+))?)\\}/g,\n          function (match, isEscapedDollar, isSeries, isCategory, colName, colFnName) {\n            if (isEscapedDollar) {\n              match = '$';\n            }\n            else if (colName) {\n              colName = colName.replace(/\\\\(.)/g, '$1');\n              if (_.has(rows[0].byColName, colName)) {\n                match = rows.map(row => row.byColName[colName]);\n                match = colFnName === 'sum'\n                  ? match.reduce((a, b) => a + b)\n                  : colFnName === 'avg'\n                    ? match.reduce((a, b) => a + b) / match.length\n                    : colFnName === 'max'\n                      ? match.reduce((a, b) => a > b ? a : b)\n                      : colFnName === 'min'\n                        ? match.reduce((a, b) => a < b ? a : b)\n                        : colFnName === 'first'\n                          ? match[0]\n                          : colFnName === 'last'\n                            ? match[match.length - 1]\n                            : colFnName === 'count'\n                              ? match.length\n                              : colFnName === 'unique-count'\n                                ? new Set(match).size\n                                : colFnName === 'list'\n                                  ? match.sort().reduce((a, b, c, d) => a + (c + 1 === d.length ? ' and ' : ', ') + b)\n                                  : colFnName === 'unique-list'\n                                    ? Array.from(new Set(match)).sort().reduce((a, b, c, d) => a + (c + 1 === d.length ? ' and ' : ', ') + b)\n                                    : colFnName === 'titlecase'\n                                      ? JS.titleCase(match[0] + '')\n                                      : colFnName === 'uppercase'\n                                        ? (match[0] + '').toUpperCase()\n                                        : colFnName === 'lowercase'\n                                          ? (match[0] + '').toLowerCase()\n                                          : match.join(',');\n              }\n            }\n            else {\n              // coerces to strings while making sure that undefined and null become empty strings\n              match = [] + [isSeries ? seriesName : isCategory ? category : strMeasure];\n            }\n            return 'number' === typeof match\n              ? +match.toFixed(5)\n              : match;\n          }\n        ) || '';\n        \n        return isForChart\n          ? wrapText(strResult, labelOptions.wrapAfter)\n          : strResult;\n      }\n    }\n\n    return {\n      ctrl,\n      data,\n      rows,\n      colIndexesByText,\n      fullPanel,\n      panel,\n      countType,\n      categoryColIndex,\n      seriesColIndex,\n      measureColIndex,\n      labelColIndex,\n      colorColIndex,\n      stackColIndex,\n      seriesStacks,\n      ignoreSeries,\n      categories,\n      series,\n      categoryCount,\n      seriesCount,\n      measures,\n      measureCount,\n      labels,\n      rowGroups,\n      baseColors,\n      bgColors,\n      borderColors,\n      sortOrder,\n      formatLabel: getLabelFormatter('${category}: ${measure}', 'chart'),\n      tooltipCallbacks: {\n        title: getLabelFormatter('${series}'),\n        label: getLabelFormatter('${category}: ${measure}')\n      },\n      testChartEvent(e, callback) {\n        let elem = this.getElementAtEvent(e)[0];\n        let isOpen;\n        if (elem) {\n          let { _datasetIndex: seriesIndex, _index: categoryIndex } = elem;\n          let category = categories[categoryIndex];\n          let seriesName = series[seriesIndex];\n          isOpen = panel.drilldownLinks.some((drilldownLink, drilldownLinkIndex) => {\n            // Check this link to see if it matches...\n            let { url, category: rgxCategory, series: rgxSeries } = drilldownLink;\n            if (url) {\n              if (parseRegExp(rgxCategory).test(category) && (ignoreSeries || parseRegExp(rgxSeries).test(seriesName))) {\n                callback(\n                  drilldownLinkIndex,\n                  rowGroups[categoryIndex + seriesIndex * categoryCount]\n                );\n                return true;\n              }\n            }\n          });\n        }\n\n        if (!isOpen) {\n          callback(-1, []);\n        }\n      }\n    };\n  }\n\n  drawPieChart(canvas) {\n    let {\n      ctrl,\n      panel,\n      labelColIndex,\n      colorColIndex,\n      categories,\n      series,\n      categoryCount,\n      measures,\n      bgColors,\n      borderColors,\n      tooltipCallbacks,\n      formatLabel,\n      testChartEvent\n    } = this.getChartOptions('pie');\n\n    let datasets = series.map((seriesName, seriesIndex) => {\n      let fnFilter = (measure, measureIndex) => ~~(measureIndex / categoryCount) === seriesIndex;\n      return {\n        label: categories,\n        data: measures.filter(fnFilter),\n        borderWidth: panel.borderWidth,\n        borderColor: borderColors.filter(fnFilter),\n        backgroundColor: bgColors.filter(fnFilter),\n        datalabels: {\n          anchor: 'center',\n          display: 'auto',\n          backgroundColor: Color(panel.labels.isBlackText ? 'white' : 'black').a(0.75).rgba(),\n          color: Color(panel.labels.isBlackText ? 'black' : 'white').rgb(),\n          borderRadius: 5,\n          formatter: formatLabel,\n          textAlign: 'center'\n        }\n      };\n    });\n\n    let chartConfig = {\n      responsive: true,\n      data: {\n        datasets,\n        labels: datasets[0].label\n      },\n      options: {\n        circumference: (panel.isSemiCircle ? 1 : 2) * Math.PI,\n        rotation: -Math.PI / (panel.isSemiCircle ? 1 : 2),\n        elements: { borderWidth: panel.borderWidth },\n        tooltips: {\n          callbacks: tooltipCallbacks\n        },\n        legend: {\n          display: panel.legend.isShowing,\n          position: panel.legend.position,\n          fullWidth: panel.legend.isFullWidth,\n          reverse: panel.legend.isReverse,\n          labels: {\n            fontColor: IS_LIGHT_THEME ? '#333' : '#CCC'\n          }\n        },\n        animation: {\n          animateScale: true,\n          animateRotate: true\n        },\n        onClick: function (e) {\n          testChartEvent.call(this, e, (drilldownLinkIndex, matchingRows) => {\n            if (drilldownLinkIndex >= 0) {\n              ctrl.openDrilldownLink(panel.drilldownLinks[drilldownLinkIndex], matchingRows);\n            }\n          });\n        },\n        hover: {\n          onHover: function (e) {\n            testChartEvent.call(this, e, (drilldownLinkIndex, matchingRows) => {\n              e.target.style.cursor = drilldownLinkIndex >= 0 ? 'pointer' : 'default';\n            });\n          }\n        }\n      }\n    };\n\n    if (DISABLE_ANIMATIONS) {\n      chartConfig.options.animation = false;\n    }\n\n    if (panel.labels.isShowing) {\n      chartConfig.plugins = [ChartDataLabels];\n    }\n\n    let ctx = canvas.getContext('2d');\n    if (panel.pieType === 'polar') {\n      Chart.PolarArea(ctx, chartConfig);\n    }\n    else {\n      chartConfig.type = panel.pieType === 'doughnut' ? 'doughnut' : 'pie';\n      new Chart(ctx, chartConfig);\n    }\n  }\n\n  drawBarChart(canvas) {\n    let {\n      ctrl,\n      panel,\n      seriesStacks,\n      ignoreSeries,\n      categories,\n      series,\n      categoryCount,\n      measures,\n      rowGroups,\n      bgColors,\n      borderColors,\n      tooltipCallbacks,\n      formatLabel,\n      testChartEvent\n    } = this.getChartOptions('bar');\n\n    // If legacy bar chart colors exist convert them to new color setup\n    if (_.has(panel, ['seriesColors', 0, 'text'])) {\n      panel.seriesColors = panel.seriesColors.map(color => color.color);\n      panel.colorSource = 'custom';\n    }\n    \n    let datasets = series.map((seriesName, seriesIndex) => {\n      let fnFilter = (measure, measureIndex) => ~~(measureIndex / categoryCount) === seriesIndex;\n      return {\n        label: seriesName,\n        data: measures.filter(fnFilter),\n        borderWidth: panel.borderWidth,\n        borderColor: borderColors.filter(fnFilter),\n        backgroundColor: bgColors.filter(fnFilter),\n        stack: panel.isStacked ? seriesStacks[seriesIndex] : seriesIndex,\n        datalabels: {\n          anchor: 'center',\n          display: 'auto',\n          backgroundColor: Color(panel.labels.isBlackText ? 'white' : 'black').a(0.75).rgba(),\n          color: Color(panel.labels.isBlackText ? 'black' : 'white').rgb(),\n          borderRadius: 5,\n          formatter: formatLabel,\n          textAlign: 'center'\n        }\n      };\n    });\n    \n    let chartConfig = {\n      type: panel.orientation === 'horizontal' ? 'horizontalBar' : 'bar',\n      data: {\n        datasets,\n        labels: categories\n      },\n      //plugins: [ChartDataLabels],\n      options: {\n        responsive: true,\n        tooltips: {\n          mode: 'point',\n          callbacks: tooltipCallbacks\n        },\n        legend: {\n          display: panel.legend.isShowing,\n          position: panel.legend.position,\n          fullWidth: panel.legend.isFullWidth,\n          reverse: panel.legend.isReverse,\n          labels: {\n            fontColor: IS_LIGHT_THEME ? '#333' : '#CCC'\n          }\n        },\n        scales: {\n          xAxes: [\n            {\n              ticks: {\n                autoSkip: panel.scales.xAxes.ticks.autoSkip,\n                minRotation: panel.scales.xAxes.ticks.minRotation,\n                maxRotation: panel.scales.xAxes.ticks.maxRotation,\n                fontColor: IS_LIGHT_THEME ? '#333' : '#CCC',\n                userCallback: function (value, index, values) {\n                  let { numberFormat, numberFormatDecimals } = panel;\n                  return (!['none', null, void 0].includes(numberFormat) && 'number' === typeof value)\n                    ? getValueFormat(numberFormat)(value, numberFormatDecimals, null)\n                    : value;\n                }\n              },\n              stacked: true,\n              gridLines: {\n                display: !!panel.scales.xAxes.gridLineOpacity,\n                color: IS_LIGHT_THEME ? `rgba(0,0,0,${+panel.scales.xAxes.gridLineOpacity})` : `rgba(255,255,255,${+panel.scales.xAxes.gridLineOpacity})`\n              }\n            }\n          ],\n          yAxes: [\n            {\n              ticks: {\n                autoSkip: panel.scales.yAxes.ticks.autoSkip,\n                minRotation: panel.scales.yAxes.ticks.minRotation,\n                maxRotation: panel.scales.yAxes.ticks.maxRotation,\n                fontColor: IS_LIGHT_THEME ? '#333' : '#CCC',\n                userCallback: function (value, index, values) {\n                  let { numberFormat, numberFormatDecimals } = panel;\n                  return (!['none', null, void 0].includes(numberFormat) && 'number' === typeof value)\n                    ? getValueFormat(numberFormat)(value, numberFormatDecimals, null)\n                    : value;\n                }\n              },\n              stacked: true,\n              gridLines: {\n                display: !!panel.scales.yAxes.gridLineOpacity,\n                color: IS_LIGHT_THEME ? `rgba(0,0,0,${+panel.scales.yAxes.gridLineOpacity})` : `rgba(255,255,255,${+panel.scales.yAxes.gridLineOpacity})`\n              }\n            }\n          ]\n        },\n        onClick: function (e) {\n          testChartEvent.call(this, e, (drilldownLinkIndex, matchingRows) => {\n            if (drilldownLinkIndex >= 0) {\n              ctrl.openDrilldownLink(panel.drilldownLinks[drilldownLinkIndex], matchingRows);\n            }\n          });\n        },\n        hover: {\n          onHover: function (e) {\n            testChartEvent.call(this, e, (drilldownLinkIndex, matchingRows) => {\n              e.target.style.cursor = drilldownLinkIndex >= 0 ? 'pointer' : 'default';\n            });\n          }\n        }\n      }\n    };\n\n    if (DISABLE_ANIMATIONS) {\n      chartConfig.options.animation = false;\n    }\n\n    if (panel.labels.isShowing) {\n      chartConfig.plugins = [ChartDataLabels];\n    }\n\n    let myChart = new Chart(canvas.getContext('2d'), chartConfig);\n  }\n\n  drawFunnelChart(canvas) {\n    let {\n      ctrl,\n      panel,\n      ignoreSeries,\n      categories,\n      series,\n      categoryCount,\n      measures,\n      rowGroups,\n      bgColors,\n      borderColors,\n      tooltipCallbacks,\n      formatLabel,\n      testChartEvent\n    } = this.getChartOptions('funnel');\n\n    let dataset = {\n      label: categories,\n      data: measures,\n      borderWidth: 1,\n      borderColor: borderColors,\n      backgroundColor: bgColors,\n      datalabels: panel.labels\n        ? {\n          anchor: 'center',\n          display: 'auto',\n          backgroundColor: Color(panel.labels.isBlackText ? 'white' : 'black').a(0.75).rgba(),\n          color: Color(panel.labels.isBlackText ? 'black' : 'white').rgb(),\n          borderRadius: 5,\n          formatter: formatLabel,\n          textAlign: 'center'\n        }\n        : null\n    };\n\n    let chartConfig = {\n      type: 'funnel',\n      responsive: true,\n      data: {\n        datasets: [ dataset ],\n        labels: 'string' === typeof dataset.label\n          ? dataset.data.map((x, i) => `${dataset.label} #${i + 1}`)\n          : dataset.label\n      },\n      options: {\n        startWidthPercent: panel.startWidthPct,\n        sort: panel.sortOrder,\n        elements: { borderWidth: panel.borderWidth },\n        gap: panel.gap,\n        keep: /^(left|right)$/.test(panel.hAlign || '') ? panel.hAlign : 'auto',\n        tooltips: {\n          callbacks: tooltipCallbacks\n        },\n        legend: {\n          display: panel.legend.isShowing,\n          position: panel.legend.position,\n          fullWidth: panel.legend.isFullWidth,\n          reverse: panel.legend.isReverse,\n          labels: {\n            fontColor: IS_LIGHT_THEME ? '#333' : '#CCC'\n          }\n        },\n        animation: {\n          animateScale: true,\n          animateRotate: true\n        },\n        onClick: function (e) {\n          testChartEvent.call(this, e, (drilldownLinkIndex, matchingRows) => {\n            if (drilldownLinkIndex >= 0) {\n              ctrl.openDrilldownLink(panel.drilldownLinks[drilldownLinkIndex], matchingRows);\n            }\n          });\n        },\n        hover: {\n          onHover: function (e) {\n            testChartEvent.call(this, e, (drilldownLinkIndex, matchingRows) => {\n              e.target.style.cursor = drilldownLinkIndex >= 0 ? 'pointer' : 'default';\n            });\n          }\n        }\n      }\n    };\n\n    if (DISABLE_ANIMATIONS) {\n      chartConfig.options.animation = false;\n    }\n\n    // if (panel.labels.isShowing) {\n    //   chartConfig.plugins = [ChartDataLabels];\n    // }\n\n    let myChart = new Chart(canvas.getContext('2d'), chartConfig);\n  }\n\n  openDrilldownLink(drilldownLink, matchingRows) {\n    let { data: { colIndexesByText }, templateSrv: { variables }, timeSrv } = this;\n    let { url, openInBlank } = drilldownLink;\n    url = url.replace(RGX_OLD_VAR_WORKAROUND, '$1$2').replace(\n      RGX_CELL_PLACEHOLDER,\n      function (match, isTime, opt_timePart, type, name, isRaw, isParam, paramName) {\n        if (isTime) {\n          let { from, to } = timeSrv.timeRangeForUrl();\n          return (opt_timePart != 'to' ? 'from=' + encodeURIComponent(from) : '')\n            + (opt_timePart ? '' : '&')\n            + (opt_timePart != 'from' ? 'to=' + encodeURIComponent(to) : '');\n        }\n\n        name = name && name.replace(/\\\\(.)/g, '$1');\n        paramName = paramName && paramName.replace(/\\\\(.)/g, '$1');\n        let result = _.uniq(\n          type == 'col'\n            ? matchingRows.map(row => row[colIndexesByText[name]])\n            : variables.reduce(\n              (values, variable) => {\n                // At times current.value is a string and at times it is an array.\n                let varValues = JS.toArray(variable.current.value);\n                let isAll = variable.includeAll && varValues.length === 1 && varValues[0] === '$__all';\n                return variable.name === name\n                  ? values.concat(isAll ? [variable.current.text] : varValues)\n                  : values;\n              },\n              []\n            )\n        );\n        return result.length < 1\n          ? match\n          : isRaw\n            ? result.join(',')\n            : isParam\n              ? result.map(v => encodeURIComponent(paramName == undefined ? type === 'var' ? `var-${name}` : name : paramName) + '=' + encodeURIComponent(v)).join('&')\n              : encodeURIComponent(result.join(','));\n      }\n    );\n    window.open(url, drilldownLink.openInBlank ? '_blank' : '_self');    \n  }\n\n  getRange() {\n    return _.range.apply(this, arguments);\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    this.events.on('renderNow', e => this.drawChart.call(this, e, elem));\n    this.events.on('render', _.debounce(e => this.drawChart.call(this, e, elem), 250));\n  }\n}\n\n// Dont add ChartDataLabels unless user requests this.\nChart.plugins.unregister(ChartDataLabels);\n\nChartJsPanelCtrl.templateUrl = 'partials/module.html';\n"],"file":"ctrl.js"}